<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>SignIn Department Admin </title>
    <meta name="description" content="app, web app, responsive, responsive layout, admin, admin panel, admin dashboard, flat, flat ui, ui kit, AngularJS, ui route, charts, widgets, components" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <link rel="stylesheet" href="admin/css/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="admin/css/animate.css" type="text/css" />
    <link rel="stylesheet" href="admin/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="admin/css/simple-line-icons.css" type="text/css" />
    <link rel="stylesheet" href="admin/css/font.css" type="text/css" />
    <link rel="stylesheet" href="admin/css/app.css" type="text/css" />

    <!--自己定义的css文件-->
    <!--<link href="css/mycss.css" rel="stylesheet" />-->
    <!--<link href="css/pagination.css" rel="stylesheet" />-->
    <style>

        #my_icon{
            margin:1px 10px;
        }

        #my_title{
            text-align: center;
            color: #56ABE4;
            font-weight: 900;
        }

        #my_navbar_heigth{
            height: 80px;
        }

        #my_navbar-cancellation{
            margin-right: 25px;
        }

        #my_navbar-sidefuncation{
            margin-top: 52px;
        }

        /* 小屏幕（平板，大于等于 768px）*/
        @media (min-width: 768px) {

            #my_navbar-sidefuncation{
                width: 250px;
                margin-top: 51px;
                position: absolute;
                z-index: 1;
                height: 620px;
            }

            #mysearch{
                margin: 10px 1px;
            }

            .mypage_main{
                margin-left: 45px;
            }
        }

        .my_breadcrumb{
            /*margin-top: -20px;*/
            margin-left: -5px;
        }

        .my_headerbuttonlist{
            list-style-type: none;
            position: relative;
            left:-2%;
            top: 5px;
        }

        .my_headerbuttonlist>li{
            position: relative;
            display: inline;
            padding: 10px 5px
        }

        #my_checkbox{
            width: 60px !important;
            /*!important强制使用该样式*/
        }
        .my_searchname{
            display: inline;
            padding-right: 15px;
            text-align: right;
            border-right: 5px solid #eee;
        }
        .f0,
        .f2
        {
            font-weight: bolder;
        }
        .modalTitle
        {
            font-size:1.75em;
        }
        .modalContent
        {
            font-size:1.125em;
            font-weight:normal;
            background-color:#f1f1f1;
        }
        .myform
        {

            margin-top:2.5em;
        }
        .row
        {
            margin-top:-0.5em;
        }
        .row label,.row input
        {
            display:inline-block;
        }
        .row label
        {
            width:13em;
            text-align:right;
            padding:0.5em;
        }
        .row1 label
        {
            width:16em;
        }
        .row input
        {
            border:2px solid #bebebe;
        }
        .submit
        {

            position:relative;
            left:12.4em;
            width:5em;
        }
    </style>

    <!--模态框样式-->
    <style>
        #modal_input,#modalActivity_input{
            float: left;
        }
        #reason_input{
            margin-top: -20px;
            margin-left: 60px;
            width: 200px;
            height: 250px;
            overflow-y: scroll;
        }
        #reasonActivity_input{
            margin-top: -20px;
            margin-left: 60px;
            width: 200px;
            height: 150px;
            overflow-y: scroll;
        }
        #reason_input_tip,#reasonActivity_input_tip{
            top: 50px;
        }
        #person_input,#personActivity_input,#tip_input,#Activity_address,
        #Activity_tip_input,#ActivityStartTime,#ActivityEndTime{
            width: 200px;
        }
        #my_addtable,#my_addtable2,#my_addtable_department{
            display: block;
            width: 35%;
            overflow-y: scroll;
            height: 270px;
            float: right;
        }
        #tableAct{
            display: block;
            width: 35%;
            overflow-y: scroll;
            height: 270px;
            float: right;
        }
        #notifySelectNotifyPerson,#activitySelectNotifyPerson{
            margin-right: 30px;
            float: right;
        }
        #my_add_releaseNotify{
            float: right;
            width: 30%;
        }
        .my_searchname{
            float: right;
        }
    </style>

    <script>
        var departmentId="";
        var departmentAdminEmployeeId="";
        var companyId="";
        function getCookie(cname){
            var name = cname + "=";
            var ca = document.cookie.split(';');
            for(var i=0; i<ca.length; i++) {
                var c = ca[i].trim();
                if (c.indexOf(name)==0) return c.substring(name.length,c.length);
            }
            return "";
        }
        //查cookie
        function checkCookie(){
            departmentId=getCookie("DepartmentId");
            departmentAdminEmployeeId=getCookie("EmployeeId");
            if (departmentId&&departmentAdminEmployeeId){

                getEmployee();
                getApplications();
                queryDepartmentSchedules();
                queryNotifies();
                queryActivites();
                getDepartmentAndEmployee();
                getAttendanceInformation(0);
                getLateInformation(0);
                getBackEarlyInformation(0);
                getLateAndBackEarlyInformation(0);
                getAbsenteeismInformation(0);
                getActivityAttendanceInformation();
                getActivityLateInformation();
                getActivityBackEarlyInformation();
                getActivityLateAndBackEarlyInformation();
                getActivityAbsenteeismInformation();
            }
            else {
//                alert("null");
                window.location.href = 'AdminLoginAndRegister.html?#';
            }
        }

    </script>

</head>
<body onload="checkCookie()" >
<div class="app app-header-fixed" id="app">
    <!-- navbar -->
    <div class="app-header navbar">
        <!-- navbar header -->
        <div class="navbar-header bg-dark">
            <button class="pull-right visible-xs dk" data-toggle="class:show" data-target=".navbar-collapse">
                <i class="glyphicon glyphicon-cog"></i>
            </button>
            <button class="pull-right visible-xs" data-toggle="class:off-screen" data-target=".app-aside" ui-scroll="app">
                <i class="glyphicon glyphicon-align-justify"></i>
            </button>
            <!-- brand -->
            <a href class="navbar-brand text-lt">
                <span class="hidden-folded m-l-xs"><img src="img/SignInLogo.png">&nbsp;&nbsp;SignIn</span>
            </a>
            <!-- / brand -->
        </div>
        <!-- / navbar header -->

        <!-- navbar collapse -->
        <div class="collapse pos-rlt navbar-collapse box-shadow bg-white-only">
            <!-- buttons -->
            <div class="nav navbar-nav hidden-xs">
                <a href="#" class="btn no-shadow navbar-btn" data-toggle="class:app-aside-folded" data-target=".app">
                    <i class="fa fa-dedent fa-fw text"></i>
                    <i class="fa fa-indent fa-fw text-active"></i>
                </a>
                <a href class="btn no-shadow navbar-btn" data-toggle="class:show" data-target="#aside-user">
                    <i class="icon-user fa-fw"></i>
                </a>
            </div>
            <!-- / buttons -->

            <!-- search form -->
            <form class="navbar-form navbar-form-sm navbar-left shift" ui-shift="prependTo" data-target=".navbar-collapse" role="search" ng-controller="TypeaheadDemoCtrl">
                <div class="form-group">
                    <div class="input-group">
                        <input type="text" ng-model="selected" typeahead="state for state in states | filter:$viewValue | limitTo:8" class="form-control input-sm bg-light no-border rounded padder" placeholder="Search projects...">
              <span class="input-group-btn">
                <button type="submit" class="btn btn-sm bg-light rounded"><i class="fa fa-search"></i></button>
              </span>
                    </div>
                </div>
            </form>
            <!-- / search form -->

            <!-- nabar right -->
            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="#" data-toggle="dropdown" class="dropdown-toggle">
                        <i class="icon-bell fa-fw"></i>
                        <span class="visible-xs-inline">Notifications</span>
                        <span class="badge badge-sm up bg-danger pull-right-xs">1</span>
                    </a>
                    <!-- dropdown -->
                    <div class="dropdown-menu w-xl animated fadeInUp">
                        <div class="panel bg-white">
                            <div class="panel-heading b-light bg-light">
                                <strong>有 <span>1</span> 条未读信息</strong>
                            </div>
                            <div class="list-group">
                                <!-- <a href class="media list-group-item">
                                  <span class="pull-left thumb-sm">
                                    <img src="img/a0.png" alt="..." class="img-circle">
                                  </span>
                                  <span class="media-body block m-b-none">
                                    Use awesome animate.css<br>
                                    <small class="text-muted">10 minutes ago</small>
                                  </span>
                                </a> -->
                                <a href class="media list-group-item">
                    <span class="media-body block m-b-none">
                      1.0 initial released<br>
                      <small class="text-muted">1 hour ago</small>
                    </span>
                                </a>
                            </div>
                            <!-- <div class="panel-footer text-sm">
                              <a href class="pull-right"><i class="fa fa-cog"></i></a>
                              <a href="#notes" data-toggle="class:show animated fadeInRight">See all the notifications</a>
                            </div> -->
                        </div>
                    </div>
                    <!-- / dropdown -->
                </li>
                <li class="dropdown">
                    <a href="#" data-toggle="dropdown" class="dropdown-toggle clear" data-toggle="dropdown">
                      <span class="thumb-sm avatar pull-right m-t-n-sm m-b-n-sm m-l-sm">
                        <img src="img/a0.png" alt="...">
                        <i class="on md b-white bottom"></i>
                      </span>
                        <!-- <span class="hidden-sm hidden-md">John.Smith</span> <b class="caret"></b> -->
                    </a>
                    <!-- dropdown -->
                    <ul class="dropdown-menu animated fadeInRight w">
                        <li class="wrapper b-b m-b-sm bg-light m-t-n-xs">
                            <div>
                                <p id="departmentName1"></p>
                            </div>
                            <progressbar value="60" class="progress-xs m-b-none bg-white"></progressbar>
                        </li>
                        <li>
                            <a onclick="showChangeTelAndEmailHtml()">
                                <span class="badge bg-danger pull-right">手机/邮箱</span>
                                <span>设置</span>
                            </a>
                        </li>
                        <!--<li>-->
                        <!--<a ui-sref="app.page.profile">Profile</a>-->
                        <!--</li>-->
                        <!--<li>-->
                        <!--<a ui-sref="app.docs">-->
                        <!--<span class="label bg-info pull-right">new</span>-->
                        <!--Help-->
                        <!--</a>-->
                        <!--</li>-->
                        <li class="divider"></li>
                        <li>
                            <a ui-sref="access.signin" onclick="outLogin()">注销</a>
                        </li>
                    </ul>
                    <!-- / dropdown -->
                </li>
            </ul>
            <!-- / navbar right -->

        </div>
        <!-- / navbar collapse -->
    </div>
    <!-- / navbar -->

    <!-- menu -->
    <div class="app-aside hidden-xs bg-dark">
        <div class="aside-wrap">
            <div class="navi-wrap">
                <!-- user -->
                <div class="clearfix hidden-xs text-center hide" id="aside-user">
                    <div class="dropdown wrapper">
                        <a ui-sref="app.page.profile">
                <span class="thumb-lg w-auto-folded avatar m-t-sm">
                  <img src="img/a0.png" class="img-full" alt="...">
                </span>
                        </a>
                        <a href="#" data-toggle="dropdown" class="dropdown-toggle hidden-folded">
                <span class="clear">
                  <span class="block m-t-sm">
                    <strong class="font-bold text-lt" id="departmentAdminName1"></strong>
                    <b class="caret"></b>
                  </span>
                  <span class="text-muted text-xs block">部门管理员</span>
                </span>
                        </a>
                        <!-- dropdown -->
                        <ul class="dropdown-menu animated fadeInRight w hidden-folded">
                            <li class="wrapper b-b m-b-sm bg-info m-t-n-xs">
                                <span class="arrow top hidden-folded arrow-info"></span>
                                <div>
                                    <p id="departmentName2"></p>
                                </div>
                                <progressbar value="60" type="white" class="progress-xs m-b-none dker"></progressbar>
                            </li>
                            <li>
                                <a href>设置</a>
                            </li>
                            <li class="divider"></li>
                            <li>
                                <a ui-sref="access.signin" onclick="outLogin()">注销</a>
                            </li>
                        </ul>
                        <!-- / dropdown -->
                    </div>
                    <div class="line dk hidden-folded"></div>
                </div>
                <!-- / user -->

                <!-- nav -->
                <!--<nav ui-nav class="navi" style="position: fixed">-->
                <nav ui-nav class="navi">
                    <ul class="nav">
                        <li class="hidden-folded padder m-t m-b-sm text-muted text-xs">
                            <span translate="aside.nav.HEADER">Welcome to SignIn</span>
                        </li>
                        <li>
                            <a href class="auto">
                              <span class="pull-right text-muted">
                                <i class="fa fa-fw fa-angle-right text"></i>
                                <i class="fa fa-fw fa-angle-down text-active"></i>
                              </span>
                                <i class="glyphicon glyphicon-user icon text-primary"></i>
                                <span class="font-bold" translate="aside.nav.CALENDAR">员工管理</span>
                            </a>
                            <ul class="nav nav-sub dk">
                                <li ui-sref-active="active">
                                    <a ui-sref="apps.note" href="#employeeListTitle" onclick="pointTitle(1)">
                                        <span>员工列表</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href class="auto">
                              <span class="pull-right text-muted">
                                <i class="fa fa-fw fa-angle-right text"></i>
                                <i class="fa fa-fw fa-angle-down text-active"></i>
                              </span>
                                <i class="glyphicon glyphicon-time icon text-warning"></i>
                                <span class="font-bold" translate="aside.nav.EMAIL">班次管理</span>
                            </a>
                            <ul class="nav nav-sub dk">

                                <li ui-sref-active="active">
                                    <a ui-sref="app.note">
                                        <b class="label bg-warning pull-right">N</b>
                                        <span data-toggle="modal" data-target="#themodal4">添加班次</span>
                                    </a>
                                </li>
                                <li ui-sref-active="active">
                                    <a ui-sref="app.note" href="#scheduleTitle" onclick="pointTitle(2)">
                                        <span>班次表</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href class="auto">
                              <span class="pull-right text-muted">
                                <i class="fa fa-fw fa-angle-right text"></i>
                                <i class="fa fa-fw fa-angle-down text-active"></i>
                              </span>
                                <i class="glyphicon glyphicon-envelope icon text-info-lter"></i>
                                <span class="font-bold" translate="aside.nav.EMAIL">通知信息</span>
                            </a>
                            <ul class="nav nav-sub dk">

                                <li ui-sref-active="active">
                                    <a ui-sref="app.note">
                                        <b class="label bg-info pull-right">N</b>
                                        <span data-toggle="modal" data-target="#notifyModal" onclick="getDepartmentAndEmployee()">发布通知信息</span>
                                    </a>
                                </li>
                                <li ui-sref-active="active">
                                    <a ui-sref="app.note" href="#notifyTitle" onclick="pointTitle(3)">
                                        <span>查看通知信息</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href class="auto">
                              <span class="pull-right text-muted">
                                <i class="fa fa-fw fa-angle-right text"></i>
                                <i class="fa fa-fw fa-angle-down text-active"></i>
                              </span>
                                <i class="glyphicon glyphicon-th-large icon text-success"></i>
                                <span class="font-bold">活动/会议</span>
                            </a>
                            <ul class="nav nav-sub dk">
                                <li ui-sref-active="active">
                                    <a ui-sref="app.note">
                                        <b class="label bg-success pull-right">N</b>
                                        <span data-toggle="modal" data-target="#activityModal" onclick="getDepartmentAndEmployee()">新增活动/会议</span>
                                    </a>
                                </li>
                                <li ui-sref-active="active">
                                    <a ui-sref="app.note" href="#activityTitle" onclick="pointTitle(4)">
                                        <span>查看活动/会议</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href class="auto">
                              <span class="pull-right text-muted">
                                <i class="fa fa-fw fa-angle-right text"></i>
                                <i class="fa fa-fw fa-angle-down text-active"></i>
                              </span>
                                <i class="glyphicon glyphicon-list-alt icon text-primary-lter"></i>
                                <span class="font-bold" translate="aside.nav.CALENDAR">修改审核</span>
                            </a>
                            <ul class="nav nav-sub dk">
                                <li ui-sref-active="active">
                                    <a ui-sref="apps.note" href="#checkTitle" onclick="pointTitle(5)">
                                        <span>审核信息</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href class="auto">
                              <span class="pull-right text-muted">
                                <i class="fa fa-fw fa-angle-right text"></i>
                                <i class="fa fa-fw fa-angle-down text-active"></i>
                              </span>
                                <i class="glyphicon glyphicon-stats icon text-info-lter"></i>
                                <span class="font-bold" translate="aside.nav.CALENDAR">数据统计</span>
                            </a>
                            <ul class="nav nav-sub dk">
                                <li ui-sref-active="active">
                                    <a ui-sref="apps.note" onclick="showDailyAttendance()">
                                        <span>日常出勤</span>
                                    </a>
                                </li>
                                <li ui-sref-active="active">
                                    <a ui-sref="apps.note" onclick="showActivityAttendanceInformation()">
                                        <span>活动出席</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href="#" class="auto">
                                <i class=" glyphicon-th-large icon-action-undo text-danger"></i>
                                <span class="font-bold" onclick="outLogin()">注销</span>
                            </a>
                        </li>
                    </ul>


                </nav>

            </div>
        </div>
    </div>
    <!-- / menu -->

    <!-- content -->
    <div class="app-content">
        <div ui-butterbar></div>
        <a href class="off-screen-toggle hide" data-toggle="class:off-screen" data-target=".app-aside" ></a>
        <div class="app-content-body fade-in-up">
            <!-- COPY the content from "tpl/" -->
            <div class="hbox hbox-auto-xs hbox-auto-sm">
                <div class="col">
                    <div style="background:url(img/c10.jpg) center center; background-size:cover">
                        <div class="wrapper-lg bg-white-opacity">
                            <div class="row m-t">
                                <div class="col-sm-7">
                                    <a href class="thumb-lg pull-left m-r">
                                        <img src="img/a0.png" class="img-circle">
                                    </a>
                                    <div class="clear m-b">
                                        <div class="m-b m-t-sm">
                                            <span class="h3 text-black" id="departmentAdminName2"></span>
                                            <!-- <small class="m-l">London, UK</small> -->
                                        </div>
                                        <p class="m-b">
                                            <small class="m-l" id="departmentName3"></small>
                                        </p>
                                        <a href="#" class="btn btn-sm btn-success btn-rounded">个人信息</a>
                                    </div>
                                </div>
                                <div class="col-sm-5">
                                    <div class="pull-right pull-none-xs text-center">
                                        <!-- <a href class="m-b-md inline m">
                                          <span class="h3 block font-bold">2k</span>
                                          <small>Followers</small>
                                        </a> -->
                                        <a href class="m-b-md inline m">
                                            <span class="h3 block font-bold" id="departmentEmployeeNum"></span>
                                            <small>员工人数</small>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /content -->


            <!-- footer -->
            <div class="app-footer wrapper b-t bg-light">
                <span class="pull-right">版本 1.0.0 <a href="#app" class="m-l-sm text-muted"><i class="fa fa-long-arrow-up"></i></a></span>
                &copy; 2017 SignIn System
            </div>
            <!-- / footer -->
        </div>

        <!----------------------------------------------部门列表、通知信息、活动/会议信息----------------------------------------------->

            <!--员工管理->员工列表界面-->
            <div class="mypage_main" id="employeeListTitle">
                <!--员工列表面包屑导航-->
                <ol class="breadcrumb my_breadcrumb" >
                    <li>
                        <a href="#">员工管理</a>
                    </li>
                    <li class="active" id="navTitle1">员工列表</li>
                </ol>

                <div class="row">
                    <div class="col-sm-12">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <ul class="my_headerbuttonlist">
                                    <li>
                                        <i class=" glyphicon glyphicon-plus  text-info"></i>
                                        <a onclick="showAddOneEmployee()"><span>添加</span></a>
                                    </li>
                                    <li>
                                        <i class=" glyphicon glyphicon-edit  text-info"></i>
                                        <a onclick="showChangeEmployee()"><span>修改</span></a>
                                    </li>
                                    <li>
                                        <i class=" glyphicon glyphicon-remove-circle  text-danger"></i>
                                        <a onclick="getAndDeleteEmployeeids()">&nbsp;<span>删除</span></a>
                                    </li>
                                    <li>
                                        <a onclick="uploadExcel()">
                                            <i class=" glyphicon glyphicon-save  text-info"></i>
                                            <span>导入Excel</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="panel-body">
                                <table class="table table-striped table-hover table-bordered">
                                    <thead>
                                    <tr>
                                        <!--调用全选js函数-->
                                        <th style="width: 8%;"><input type="checkbox" id="my_departmentlist_checkbox_selectall" onclick="departmentlist_select_all()"/></th>
                                        <th>姓名</th>
                                        <th>职位</th>
                                        <th>性别</th>
                                        <th>联系电话</th>
                                        <th>邮箱地址</th>
                                    </tr>
                                    </thead>

                                    <tbody id="employee">
                                    <!--<tr>-->
                                        <!--<td><input type="checkbox" id="my_departmentlist_checkbox_1"/></td>-->
                                        <!--<td>1213123</td>-->
                                        <!--<td>张三</td>-->
                                        <!--<td>男</td>-->
                                        <!--<td>13428003404</td>-->
                                        <!--<td>13428003404@139.com</td>-->
                                    <!--</tr>-->
                                    </tbody>
                                </table>
                                <!--分页-->
                                <!--<div id="Pagination1" class="pagination">-->
                                <!--</div>-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- 班次 -->
            <div class="mypage_main" id="scheduleTitle" >
                <!--员工列表面包屑导航-->
                <ol class="breadcrumb my_breadcrumb">
                    <li>
                        <a href="#">班次管理</a>
                    </li>
                    <li class="active" id="navTitle2">班次表</li>
                </ol>

                <div class="row">
                    <div class="col-sm-12">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <ul class="my_headerbuttonlist">
                                    <li>
                                        <a onclick="showAddDepartmentSchedule()">
                                            <i class=" glyphicon glyphicon-plus  text-info"></i>
                                             <span>添加</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a onclick="showChangeDepartmentSchedule()">
                                            <i class=" glyphicon glyphicon-edit  text-info"></i>
                                            <span>修改</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a onclick="getAndDeleteDepartmentSchedules()">
                                            <i class=" glyphicon glyphicon-remove-circle  text-danger"></i>
                                            <span>删除</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div  class="panel-body">
                                <table class="table table-striped table-hover table-bordered">
                                    <thead>
                                    <tr>
                                        <!--调用全选js函数-->
                                        <th style="width: 8%;"><input type="checkbox" id="my_employeeslist_checkbox_selectall" onclick="employeeslist_select_all()"/></th>
                                        <th>班次</th>
                                        <th>上班时间</th>
                                        <th>下班时间</th>
                                    </tr>
                                    </thead>

                                    <tbody id="departmentSchedules">

                                    </tbody>
                                </table>
                                <!--分页-->
                                <!--<div id="Pagination4" class="pagination">-->
                                <!--</div>-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!--发布通知->待通知信息界面-->
            <div class="mypage_main" id="notifyTitle">
                <!--待通知信息面包屑导航-->
                <ol class="breadcrumb my_breadcrumb">
                    <li>
                        <a href="#">通知信息</a>
                    </li>
                    <li class="active" id="navTitle3">查看通知信息</li>
                </ol>

                <div class="row">
                    <div class="col-sm-12">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <ul class="my_headerbuttonlist">
                                    <li>
                                        <!--跳转到模态框，模态框定义放在最下面-->
                                        <i class=" glyphicon glyphicon-pencil  text-info"></i>
                                        <a href="#"><span data-toggle="modal" data-target="#notifyModal" onclick="getDepartmentAndEmployee()">发布通知</span></a>
                                    </li>
                                    <!--<li>-->
                                        <!--<i class=" glyphicon glyphicon-folder-open  text-info"></i>-->
                                        <!--<a id="f0"><span>已读通知</span></a>-->
                                    <!--</li>-->
                                    <!--<li>-->
                                        <!--<i class=" glyphicon glyphicon-folder-close  text-info"></i>-->
                                        <!--<a id="f1"><span>未读通知</span></a>-->
                                    <!--</li>-->
                                    <li>
                                        <a id="f0">
                                            <i class=" glyphicon glyphicon-folder-close  text-info"></i>
                                            <span>未读通知</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a id="f1">
                                            <i class=" glyphicon glyphicon-folder-open  text-info"></i>
                                            <span>已读通知</span>
                                        </a>
                                    </li>
                                    <!--<li>-->
                                    <!--<a href="#">-->
                                    <!--<img src="img/export_excel.png" alt="导出Excel">&nbsp;<span>导出Excel</span>-->
                                    <!--</a>-->
                                    <!--</li>-->
                                    <!--<li>-->
                                    <!--<div class="my_searchname navbar-right">-->
                                    <!--<input type="text" placeholder="请输入要查找的通知信息" />-->
                                    <!--<a href="#"><img src="img/search_button.png" alt="搜索"></a>-->
                                    <!--</div>-->
                                    <!--</li>-->
                                </ul>
                            </div>
                            <div class="panel-body">
                                <table class="table table-striped table-hover table-bordered">
                                    <thead>
                                    <tr>
                                        <!--调用全选js函数-->
                                        <!--<th><input type="checkbox" id="my_prepare_notify_checkbox_selectall" onclick="prepare_notify_select_all()"/></th>-->
                                        <th style="width: 8%;"><span class="glyphicon glyphicon-info-sign"></span></th>
                                        <th>通知主题</th>
                                        <th>通知单位</th>
                                        <th>通知时间</th>
                                    </tr>
                                    </thead>

                                    <tbody id="notifies">

                                    </tbody>
                                </table>
                                <!--分页-->
                                <!--<div id="Pagination2" class="pagination">-->
                                <!--</div>-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!--查看活动/会议-->
            <div class="mypage_main" id="activityTitle">
                <!--员工出勤情况记录表面包屑导航-->
                <ol class="breadcrumb my_breadcrumb">
                    <li>
                        <a href="#">活动/会议</a>
                    </li>
                    <li class="active" id="navTitle4">查看活动/会议</li>
                </ol>

                <div class="row">
                    <div class="col-sm-12">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <ul class="my_headerbuttonlist">
                                    <li>
                                        <!--跳转到模态框，模态框定义放在最下面-->
                                        <i class=" glyphicon glyphicon-plus-sign  text-info"></i>
                                        <a href="#"><span data-toggle="modal" data-target="#activityModal" onclick="getDepartmentAndEmployee()">添加活动/会议</span></a>
                                    </li>
                                    <!--<li>-->
                                    <!--<a href="#"><img src="img/document_letter_okay.png" alt="显示已读信息">&nbsp;<span>显示已读信息</span></a>-->
                                    <!--</li>-->
                                    <!--<li>-->
                                    <!--<a href="#"><img src="img/document_letter_new.png" alt="显示未读信息">&nbsp;<span>显示未读信息</span></a>-->
                                    <!--</li>-->
                                    <!--<li>-->
                                    <!--<a href="#">-->
                                    <!--<img src="img/export_excel.png" alt="导出Excel">&nbsp;<span>导出Excel</span>-->
                                    <!--</a>-->
                                    <!--</li>-->
                                </ul>
                            </div>
                            <div class="panel-body">
                                <table class="table table-striped table-hover table-bordered">
                                    <thead>
                                    <tr>
                                        <!--调用全选js函数-->
                                        <!--<th><input type="checkbox" id="my_attend_checkbox_selectall" onclick="attend_select_all()"/></th>-->
                                        <th style="width: 8%;"><span class="glyphicon glyphicon-info-sign"></span></th>
                                        <th>主题</th>
                                        <th>开始时间</th>
                                        <th>结束时间</th>
                                        <th>地点</th>
                                        <th>类型</th>
                                    </tr>
                                    </thead>

                                    <tbody id="activities">

                                    </tbody>
                                </table>
                                <!--<div id="Pagination3" class="pagination">-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--  审核信息  -->
            <div class="mypage_main" id="checkTitle">
                <!--部门总体出勤情况面包屑导航-->
                <ol class="breadcrumb my_breadcrumb">
                    <li>
                        <a href="#">修改审核</a>
                    </li>
                    <li class="active" id="navTitle5">审核信息</li>
                </ol>

                <div class="row">
                    <div class="col-sm-12">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <ul class="my_headerbuttonlist">
                                    <li>
                                        <a id="f2">
                                            <i class=" glyphicon glyphicon-folder-close  text-info"></i>
                                            <span>未审核的信息</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a id="f3">
                                            <i class=" glyphicon glyphicon-folder-open  text-info"></i>
                                            <span>已审核的信息</span>
                                        </a>
                                    </li>
                                    <!--<li>-->
                                        <!--<a href="#">-->
                                            <!--<span>导出Excel</span>-->
                                        <!--</a>-->
                                    <!--</li>-->

                                </ul>
                            </div>

                            <div class="panel-body">
                                <table class="table table-striped table-hover table-bordered">
                                    <thead>
                                    <tr>
                                        <!--调用全选js函数-->
                                        <!--<th><input type="checkbox" id="my_departmentAttendlist_checkbox_selectall" onclick="departmentAttendlist_select_all()"/></th>-->
                                        <th style="width: 8%;"><span class="glyphicon glyphicon-info-sign"></span></th>
                                        <th>Id</th>
                                        <th>标题</th>
                                        <th>时间</th>
                                    </tr>
                                    </thead>

                                    <tbody id="applications">

                                    </tbody>
                                </table>
                                <!--分页-->
                                <!--<div id="Pagination2" class="pagination">-->
                                <!--</div>-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>



        <!-------------------------------------------统计数据页面------------------------------------------------------>
        <!--<div class="mypage_main" id="dataInformationHtml" style="display:block">-->
        <div class="mypage_main" style="display: none;height: 400px" id="attendanceInformationHtml">
            <!--部门列表面包屑导航-->
            <ol class="breadcrumb my_breadcrumb">
                <li>
                    <a href="#">数据统计</a>
                </li>
                <li class="active"> 日常出勤记录</li>
            </ol>

                 <div class="btn-group btn-group-justified" role="group" aria-label="...">
                     <div class="btn-group" role="group">
                          <button type="button" class="btn btn-default" onclick="showLateData()">迟到</button>
                     </div>
                     <div class="btn-group" role="group">
                          <button type="button" class="btn btn-default" onclick="showBackEarlyData()">早退</button>
                     </div>
                     <div class="btn-group" role="group">
                          <button type="button" class="btn btn-default" onclick="showLateAndBackEarly()">迟到&早退</button>
                     </div>
                     <div class="btn-group" role="group">
                         <button type="button" class="btn btn-default" onclick="showAttendance()">出勤</button>
                     </div>
                     <div class="btn-group" role="group">
                         <button type="button" class="btn btn-default" onclick="showAbsenteeism()">缺勤</button>
                     </div>
                     <div class="btn-group" role="group">
                         <button type="button" class="btn btn-default" onclick="showAllData()">全部数据</button>
                     </div>
                 </div>

        </div>
        <!-------------------------------------------统计数据页面------------------------------------------------------>

    <!--统计内容-->

        <!--迟到-->
        <div class="mypage_main" style="display: none" id="lateInformationTitle">
            <!--部门总体出勤情况面包屑导航-->
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <ul class="my_headerbuttonlist">
                                <li>
                                    <span style="color: #E67E22">迟到记录</span>
                                </li>
                                <li>
                                    <a onclick="dayBeforeOfLate()">
                                        <i class=" glyphicon glyphicon-arrow-left  text-info"></i>
                                        <span>前一天</span>
                                    </a>
                                </li>
                                <li>
                                    <a onclick="dayAfterOfLate()">
                                        <i class=" glyphicon glyphicon-arrow-right  text-info"></i>
                                        <span>后一天</span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <i class=" glyphicon glyphicon-calendar  text-info"></i>
                                        <span id="dayOfLate">日期</span>
                                    </a>
                                </li>
                                <li>
                                    <a onclick="getLateInformation(0)">
                                        <i class=" glyphicon glyphicon-map-marker  text-info"></i>
                                        <span>当前日期</span>
                                    </a>
                                </li>

                            </ul>
                        </div>

                        <div class="panel-body">
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                <tr>
                                    <th>姓名</th>
                                    <th>进入时间</th>
                                    <th>离开时间</th>
                                    <th>累计时间</th>
                                </tr>
                                </thead>
                                <tbody id="lateInformation">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--早退-->
        <div class="mypage_main" style="display: none" id="getBackEarlyInformationTitle">
            <!--部门总体出勤情况面包屑导航-->
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <ul class="my_headerbuttonlist">
                                <li>
                                    <span style="color: #E67E22">早退记录</span>
                                </li>
                                <li>
                                    <a onclick="dayBeforeOfBackEarly()">
                                        <i class=" glyphicon glyphicon-arrow-left  text-info"></i>
                                        <span>前一天</span>
                                    </a>
                                </li>
                                <li>
                                    <a onclick="dayAfterOfBackEarly()">
                                        <i class=" glyphicon glyphicon-arrow-right  text-info"></i>
                                        <span>后一天</span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <i class=" glyphicon glyphicon-calendar  text-info"></i>
                                        <span id="dayOfBackEarly">日期</span>
                                    </a>
                                </li>
                                <li>
                                    <a onclick="getBackEarlyInformation(0)">
                                        <i class=" glyphicon glyphicon-map-marker  text-info"></i>
                                        <span>当前日期</span>
                                    </a>
                                </li>

                            </ul>
                        </div>

                        <div class="panel-body">
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                <tr>
                                    <th>姓名</th>
                                    <th>进入时间</th>
                                    <th>离开时间</th>
                                    <th>累计时间</th>
                                </tr>
                                </thead>
                                <tbody id="getBackEarlyInformation">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--迟到&早退-->
        <div class="mypage_main" style="display: none" id="lateAndBackEarlyInformationTitle">
            <!--部门总体出勤情况面包屑导航-->
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <ul class="my_headerbuttonlist">
                                <li>
                                    <span style="color: #E67E22">迟到&早退</span>
                                </li>
                                <li>
                                    <a onclick="dayBeforeOfLateAndBackEarly()">
                                        <i class=" glyphicon glyphicon-arrow-left  text-info"></i>
                                        <span>前一天</span>
                                    </a>
                                </li>
                                <li>
                                    <a onclick="dayAfterOfLateAndBackEarly()">
                                        <i class=" glyphicon glyphicon-arrow-right  text-info"></i>
                                        <span>后一天</span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <i class=" glyphicon glyphicon-calendar  text-info"></i>
                                        <span id="dayOfLateAndBackEarly">日期</span>
                                    </a>
                                </li>
                                <li>
                                    <a onclick="getLateAndBackEarlyInformation(0)">
                                        <i class=" glyphicon glyphicon-map-marker  text-info"></i>
                                        <span>当前日期</span>
                                    </a>
                                </li>

                            </ul>
                        </div>
                        <div class="panel-body">
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                <tr>
                                    <th>姓名</th>
                                    <th>进入时间</th>
                                    <th>离开时间</th>
                                    <th>累计时间</th>
                                </tr>
                                </thead>
                                <tbody id="lateAndBackEarlyInformation">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--出勤-->
        <div class="mypage_main" style="display: none" id="attendanceInformationTitle">
            <!--部门总体出勤情况面包屑导航-->
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <ul class="my_headerbuttonlist">
                                <li>
                                    <span style="color: #E67E22">出勤记录</span>
                                </li>
                                <li>
                                    <a onclick="dayBeforeOfAttendance()">
                                        <i class=" glyphicon glyphicon-arrow-left  text-info"></i>
                                        <span>前一天</span>
                                    </a>
                                </li>
                                <li>
                                    <a onclick="dayAfterOfAttendance()">
                                        <i class=" glyphicon glyphicon-arrow-right  text-info"></i>
                                        <span>后一天</span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <i class=" glyphicon glyphicon-calendar  text-info"></i>
                                        <span id="dayOfAttendance">日期</span>
                                    </a>
                                </li>
                                <li>
                                    <a onclick="getAttendanceInformation(0)">
                                        <i class=" glyphicon glyphicon-map-marker  text-info"></i>
                                        <span>当前日期</span>
                                    </a>
                                </li>

                            </ul>
                        </div>

                        <div class="panel-body">
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                <tr>
                                    <th>姓名</th>
                                    <th>进入时间</th>
                                    <th>离开时间</th>
                                    <th>累计时间</th>
                                </tr>
                                </thead>
                                <tbody id="attendanceInformation">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--缺勤-->
        <div class="mypage_main" style="display: none" id="absenteeismInformationTitle">
            <!--部门总体出勤情况面包屑导航-->
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <ul class="my_headerbuttonlist">
                                <li>
                                    <span style="color: #E67E22">缺勤记录</span>
                                </li>
                                <li>
                                    <a onclick="dayBeforeOfAbsenteeism()">
                                        <i class=" glyphicon glyphicon-arrow-left  text-info"></i>
                                        <span>前一天</span>
                                    </a>
                                </li>
                                <li>
                                    <a onclick="dayAfterOfAbsenteeism()">
                                        <i class=" glyphicon glyphicon-arrow-right  text-info"></i>
                                        <span>后一天</span>
                                    </a>
                                </li>
                                <li>
                                    <a>
                                        <i class=" glyphicon glyphicon-calendar  text-info"></i>
                                        <span id="dayOfAbsenteeism">日期</span>
                                    </a>
                                </li>
                                <li>
                                    <a onclick="getAbsenteeismInformation(0)">
                                        <i class=" glyphicon glyphicon-map-marker  text-info"></i>
                                        <span>当前日期</span>
                                    </a>
                                </li>

                            </ul>
                        </div>

                        <div class="panel-body">
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                <tr>
                                    <!--调用全选js函数-->
                                    <!--<th><input type="checkbox" id="my_departmentAttendlist_checkbox_selectall" onclick="departmentAttendlist_select_all()"/></th>-->
                                    <!--<th style="width: 8%;"><span class="glyphicon glyphicon-info-sign"></span></th>-->
                                    <th>姓名</th>
                                    <th>进入时间</th>
                                    <th>离开时间</th>
                                    <th>累计时间</th>
                                </tr>
                                </thead>
                                <tbody id="absenteeismInformation">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="mypage_main" style="height: 600px;display: none" id="allDateGraph">
            <div id="container" style="width: 1000px; height: 400px; margin: 0 auto"></div>
        </div>



        <!--活动/会议 统计-->
        <div class="mypage_main" style="display: none;height: 400px" id="activityInformationHtml">
            <!--部门列表面包屑导航-->
            <ol class="breadcrumb my_breadcrumb">
                <li>
                    <a href="#">数据统计</a>
                </li>
                <li class="active"> 活动出席记录</li>
            </ol>

            <div class="btn-group btn-group-justified" role="group" aria-label="...">
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-default" onclick="showActivityLateData()">迟到</button>
                </div>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-default" onclick="showActivityBackEarlyData()">早退</button>
                </div>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-default" onclick="showActivityLateAndBackEarly()">迟到&早退</button>
                </div>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-default" onclick="showActivityAttendance()">出勤</button>
                </div>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-default" onclick="showActivityAbsenteeism()">缺勤</button>
                </div>
                <!--<div class="btn-group" role="group">-->
                    <!--<button type="button" class="btn btn-default" onclick="showActivityAllData()">全部数据</button>-->
                <!--</div>-->
            </div>

        </div>

    <!--活动记录-->
        <!--迟到-->
        <div class="mypage_main" style="display: none" id="activityLateInformationTitle">
            <!--部门总体出勤情况面包屑导航-->
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <ul class="my_headerbuttonlist">
                                <li>
                                    <span style="color: #E67E22">活动/会议 迟到记录</span>
                                </li>
                                <!--<li>-->
                                    <!--<a onclick="dayBeforeOfActivityLate()">-->
                                        <!--<i class=" glyphicon glyphicon-arrow-left  text-info"></i>-->
                                        <!--<span>前一天</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a onclick="dayAfterOfActivityLate()">-->
                                        <!--<i class=" glyphicon glyphicon-arrow-right  text-info"></i>-->
                                        <!--<span>后一天</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a>-->
                                        <!--<i class=" glyphicon glyphicon-calendar  text-info"></i>-->
                                        <!--<span id="dayOfActivityLate">日期</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a onclick="getActivityLateInformation(0)">-->
                                        <!--<i class=" glyphicon glyphicon-map-marker  text-info"></i>-->
                                        <!--<span>当前日期</span>-->
                                    <!--</a>-->
                                <!--</li>-->

                            </ul>
                        </div>

                        <div class="panel-body">
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                <tr>
                                    <th>姓名</th>
                                    <th>进入时间</th>
                                    <th>离开时间</th>
                                    <th>活动/会议 名称</th>
                                </tr>
                                </thead>
                                <tbody id="activityLateInformation">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--早退-->
        <div class="mypage_main" style="display: none" id="getActivityBackEarlyInformationTitle">
            <!--部门总体出勤情况面包屑导航-->
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <ul class="my_headerbuttonlist">
                                <li>
                                    <span style="color: #E67E22">活动/会议 早退记录</span>
                                </li>
                                <!--<li>-->
                                    <!--<a onclick="dayBeforeOfActivityBackEarly()">-->
                                        <!--<i class=" glyphicon glyphicon-arrow-left  text-info"></i>-->
                                        <!--<span>前一天</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a onclick="dayAfterOfActivityBackEarly()">-->
                                        <!--<i class=" glyphicon glyphicon-arrow-right  text-info"></i>-->
                                        <!--<span>后一天</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a>-->
                                        <!--<i class=" glyphicon glyphicon-calendar  text-info"></i>-->
                                        <!--<span id="dayOfActivityBackEarly">日期</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a onclick="getActivityBackEarlyInformation(0)">-->
                                        <!--<i class=" glyphicon glyphicon-map-marker  text-info"></i>-->
                                        <!--<span>当前日期</span>-->
                                    <!--</a>-->
                                <!--</li>-->

                            </ul>
                        </div>

                        <div class="panel-body">
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                <tr>
                                    <th>姓名</th>
                                    <th>进入时间</th>
                                    <th>离开时间</th>
                                    <th>活动/会议 名称</th>
                                </tr>
                                </thead>
                                <tbody id="activityBackEarlyInformation">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--迟到&早退-->
        <div class="mypage_main" style="display: none" id="activityLateAndBackEarlyInformationTitle">
            <!--部门总体出勤情况面包屑导航-->
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <ul class="my_headerbuttonlist">
                                <li>
                                    <span style="color: #E67E22">活动/会议 迟到&早退</span>
                                </li>
                                <!--<li>-->
                                    <!--<a onclick="dayBeforeOfActivityLateAndBackEarly()">-->
                                        <!--<i class=" glyphicon glyphicon-arrow-left  text-info"></i>-->
                                        <!--<span>前一天</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a onclick="dayAfterOfActivityLateAndBackEarly()">-->
                                        <!--<i class=" glyphicon glyphicon-arrow-right  text-info"></i>-->
                                        <!--<span>后一天</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a>-->
                                        <!--<i class=" glyphicon glyphicon-calendar  text-info"></i>-->
                                        <!--<span id="dayOfActivityLateAndBackEarly">日期</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a onclick="getActivityLateAndBackEarlyInformation(0)">-->
                                        <!--<i class=" glyphicon glyphicon-map-marker  text-info"></i>-->
                                        <!--<span>当前日期</span>-->
                                    <!--</a>-->
                                <!--</li>-->

                            </ul>
                        </div>
                        <div class="panel-body">
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                <tr>
                                    <th>姓名</th>
                                    <th>进入时间</th>
                                    <th>离开时间</th>
                                    <th>活动/会议 名称</th>
                                </tr>
                                </thead>
                                <tbody id="activityLateAndBackEarlyInformation">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--出勤-->
        <div class="mypage_main" style="display: none" id="activityAttendanceInformationTitle">
            <!--部门总体出勤情况面包屑导航-->
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <ul class="my_headerbuttonlist">
                                <li>
                                    <span style="color: #E67E22">活动/会议 出席记录</span>
                                </li>
                                <!--<li>-->
                                    <!--<a onclick="dayBeforeOfActivityAttendance()">-->
                                        <!--<i class=" glyphicon glyphicon-arrow-left  text-info"></i>-->
                                        <!--<span>前一天</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a onclick="dayAfterOfActivityAttendance()">-->
                                        <!--<i class=" glyphicon glyphicon-arrow-right  text-info"></i>-->
                                        <!--<span>后一天</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a>-->
                                        <!--<i class=" glyphicon glyphicon-calendar  text-info"></i>-->
                                        <!--<span id="dayOfActivityAttendance">日期</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a onclick="getAttendanceInformation(0)">-->
                                        <!--<i class=" glyphicon glyphicon-map-marker  text-info"></i>-->
                                        <!--<span>当前日期</span>-->
                                    <!--</a>-->
                                <!--</li>-->

                            </ul>
                        </div>

                        <div class="panel-body">
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                <tr>
                                    <th>姓名</th>
                                    <th>进入时间</th>
                                    <th>离开时间</th>
                                    <th>活动/会议 名称</th>
                                </tr>
                                </thead>
                                <tbody id="activityAttendanceInformation">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--缺勤-->
        <div class="mypage_main" style="display: none" id="activityAbsenteeismInformationTitle">
            <!--部门总体出勤情况面包屑导航-->
            <div class="row">
                <div class="col-sm-12">
                    <div class="panel panel-default">

                        <div class="panel-heading">
                            <ul class="my_headerbuttonlist">
                                <li>
                                    <span style="color: #E67E22">活动/会议 缺席记录</span>
                                </li>
                                <!--<li>-->
                                    <!--<a onclick="dayBeforeOfActivityAbsenteeism()">-->
                                        <!--<i class=" glyphicon glyphicon-arrow-left  text-info"></i>-->
                                        <!--<span>前一天</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a onclick="dayAfterOfActivityAbsenteeism()">-->
                                        <!--<i class=" glyphicon glyphicon-arrow-right  text-info"></i>-->
                                        <!--<span>后一天</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a>-->
                                        <!--<i class=" glyphicon glyphicon-calendar  text-info"></i>-->
                                        <!--<span id="dayOfActivityAbsenteeism">日期</span>-->
                                    <!--</a>-->
                                <!--</li>-->
                                <!--<li>-->
                                    <!--<a onclick="getActivityAbsenteeismInformation(0)">-->
                                        <!--<i class=" glyphicon glyphicon-map-marker  text-info"></i>-->
                                        <!--<span>当前日期</span>-->
                                    <!--</a>-->
                                <!--</li>-->

                            </ul>
                        </div>

                        <div class="panel-body">
                            <table class="table table-striped table-hover table-bordered">
                                <thead>
                                <tr>
                                    <!--调用全选js函数-->
                                    <!--<th><input type="checkbox" id="my_departmentAttendlist_checkbox_selectall" onclick="departmentAttendlist_select_all()"/></th>-->
                                    <!--<th style="width: 8%;"><span class="glyphicon glyphicon-info-sign"></span></th>-->
                                    <th>姓名</th>
                                    <th>进入时间</th>
                                    <th>离开时间</th>
                                    <th>活动/会议 名称</th>
                                </tr>
                                </thead>
                                <tbody id="activityAbsenteeismInformation">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="mypage_main" style="height: 600px;display: none" id="activityAllDateGraph">
            <div id="container2" style="width: 1000px; height: 400px; margin: 0 auto"></div>
        </div>



        <!-----------------------------------------------修改手机号码和邮箱的页面------------------------------------------------->

        <!--<div class="mypage_main" style="display:none" id="changeTelAndEmailHtml">-->
        <div class="mypage_main" style="display:none;height: 800px;" id="changeTelAndEmailHtml">
            <!--部门列表面包屑导航-->
            <ol class="breadcrumb my_breadcrumb">
                <li>
                    <a href="#">账户设置</a>
                </li>
                <li class="active"> 手机号码/邮箱号绑定</li>
            </ol>

            <div id="contentChangeTelAndEmail">
                <div class="col-sm-10" style="padding-left:8%;padding-top:6%;">
                    <div >
                        <!--绑定手机内容-->
                        <div id="BT">
                            <table class="table ">
                                <thead>
                                <tr>
                                    <th style="color: #00a8f3 ;font-size: 120%;font-weight: inherit">手机号码
                                        <a style="float: right;top: -10px" href="#" onclick="bindTel()"><i class="glyphicon glyphicon-ok icon text-success"></i>&nbsp;<span>保存</span></a>
                                    </th>
                                </tr>
                                </thead>

                                <tbody>
                                <tr>
                                    <td><input type="text" class="form-control" placeholder="未绑定手机号码" id="Tel" value=""></td>
                                </tr>
                                <tr>
                                    <td><input type="text" class="form-control" placeholder="请输入验证码" id="code"></td>
                                </tr>
                                <tr>
                                    <td><input type="button" class="form-control btn-success"  id="sendMessageTime" value="免费获取验证码" onclick="sendMessage()" /> </td>
                                </tr>

                                </tbody>

                            </table>
                        </div>
                        <div style="padding-top:5%;">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th style="color: #00a8f3 ;font-size: 120%;font-weight: inherit">邮箱号码
                                        <a style="float: right;top: -10px" href="#" onclick="bindEmail ()"><i class="glyphicon glyphicon-ok icon text-success"></i>&nbsp;<span>保存</span></a>
                                    </th>
                                </tr>
                                </thead>

                                <tbody>
                                <tr>
                                    <td><input type="text" class="form-control" placeholder="未绑定邮箱" id="EmailAddress" value=""></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
            <!--修改/绑定成功后返回刷新-->


        </div>
        <div id="tip" style="display:none">
            <span style="color: #56ABE4;font-weight: bold;padding-left: 40%;">修改成功！ <button class="btn btn-group-vertical" onclick="location.reload()">返回</button></span>
        </div>
        <!-----------------------------------------------/修改手机号码和邮箱的页面------------------------------------------------->


    </div>
    </div>
</div>


<!-----------------------------------------------发布通知模态框------------------------------------------------->

<div class="modal fade" id="notifyModal" tabindex="-1" role="dialog" aria-labelledby="notifyModalLabel"  data-backdrop="static" >
    <!--data-backdrop="static"指定一个静态的背景，当用户点击模态框外部时不会关闭模态框-->
    <!--data-keyboard是指当按下ESC键时关闭模态框，设置为 false 时则按键无效-->

    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="notifyModalLabel" >发布通知</h4>
            </div>
            <div class="modal-body">
                <div id="modal_input">
                    <form>
                        <div  class="form-group">
                            <span>通知主题</span>
                            <!--<input id="tip_input" type="text"/>-->
                            <input style="float: right" type="text" class="form-control" id="tip_input" placeholder="主题">
                        </div>
                        <br>
                        <div  class="form-group">
                            <div><span id="reason_input_tip">通知内容</span></div>
                            <textarea class="form-control" id="reason_input" rows="2" placeholder="内容"></textarea>
                            <!--<textarea id="reason_input" placeholder=""></textarea>-->
                        </div>
                        <!--<div  class="form-group">-->
                        <!--<span>发布</span>-->
                        <!--<input id="person_input" type="text"/>-->
                        <!--</div>-->
                    </form>
                </div>
                <!--<div class="my_searchname navbar-right">-->
                    <!--<input type="text" placeholder="输入部门名称搜索">-->
                    <!--<a href="#"><img src="img/search_button.png" alt="搜索部门"></a>-->
                <!--</div>-->
                <!--<br />-->
                <!--<br />-->

                <div id="notifySelectNotifyPerson" class="btn-group navbar-right">
                    <button id="NotifyDepartment" class="btn" onclick="showDepartment_Notify(1);">通知部门</button>
                    <button id="NotifyEmployees" class="btn" onclick="showEmployees_Notify(1);">通知员工</button>
                </div>

                <div id="my_addtable_department" class="pull-right" style=" display:none;width: 36%;overflow-y: scroll;height: 220px;margin-right: 10px;float: right;margin-top: 10px">
                    <table class="table">
                        <thead>
                        <!--<tr>-->
                        <!--<th>部门</th>-->
                        <!--<th>-->
                        <!--<input  type="checkbox" id="addDepartment_checkbox_selectall1" onclick="addDepartment_checkbox_selectall(1)"/>-->
                        <!--</th>-->
                        <!--</tr>-->
                        <tr id="Department1">
                            <!--模态框内容-->
                        </tr>
                        </thead>
                    </table>
                </div>

                <div id="my_addtable_employee" class="pull-right" style="display:none;width: 36%;overflow-y: scroll;height: 220px;margin-right: 10px;float: right;margin-top: 10px">
                    <table class="table">
                        <thead>
                        <!--<tr>-->
                        <!--<th>部门</th>-->
                        <!--<th>-->
                        <!--<input  type="checkbox" id="addDepartment_checkbox_selectall1" onclick="addDepartment_checkbox_selectall(1)"/>-->
                        <!--</th>-->
                        <!--</tr>-->
                        <tr id="Employee1">
                            <!--模态框内容-->
                        </tr>
                        </thead>
                    </table>
                </div>


            </div>
            <div class="modal-footer" style="margin-top: 300px">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消关闭</button>
                <button type="button" class="btn btn-primary" onclick="sendNotify()">确认发布</button>
            </div>
        </div>
    </div>
</div>

<!--------------------------------------------发布通知模态框----------------------------------------------->



<!--------------------------------------新增活动/会议的模态框------------------------------------------------>

<div class="modal fade" id="activityModal" tabindex="-1" role="dialog" aria-labelledby="activityModalLabel"  data-backdrop="static"  >
    <!--data-backdrop="static"指定一个静态的背景，当用户点击模态框外部时不会关闭模态框-->
    <!--data-keyboard是指当按下ESC键时关闭模态框，设置为 false 时则按键无效-->

    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="activityModalLabel">新增活动/会议</h4>
            </div>
            <div class="modal-body">
                <div id="modalActivity_input">
                    <form>
                        <div  class="form-group">
                            <span>主 题</span>
                            <input style="float: right" type="text" class="form-control" id="Activity_tip_input" placeholder="主题">
                            <!--<input id="Activity_tip_input" class="form-control" type="text"/>-->
                        </div>
                        <div  class="form-group">
                            <span>地 点</span>
                            <input style="float: right" id="Activity_address" class="form-control" type="text" placeholder="地点"/>
                        </div>
                        <div  class="form-group">
                            <span id="reasonActivity_input_tip">内 容</span>
                            <textarea id="reasonActivity_input" class="form-control" placeholder="内容"></textarea>
                        </div>
                        <div  class="form-group">
                            <span>起始时间</span>
                            <input style="float: right" type="datetime-local" class="form-control" id="ActivityStartTime"/>
                        </div>
                        <div>
                            <span>截止时间</span>
                            <input style="float: right" type="datetime-local" class="form-control" id="ActivityEndTime"/>
                        </div>
                    </form>
                </div>
                <!--<div class="my_searchname navbar-right">-->
                    <!--<input type="text" placeholder="输入部门名称搜索">-->
                    <!--<a href="#"><img src="img/search_button.png" alt="搜索部门"></a>-->
                <!--</div>-->
                <!--<br />-->
                <!--<br />-->

                <div id="activitySelectNotifyPerson" class="btn-group navbar-right">
                    <button id="activityDepartment" class="btn" onclick="showDepartment_Activity(2);">选择部门</button>
                    <button id="activityEmployees" class="btn" onclick="showEmployees_Activity(2);">选择员工</button>
                </div>

                <div id="activity_addtable_department" class="pull-right" style=" display:none;width: 36%;overflow-y: scroll;height: 220px;margin-right: 10px;float: right;margin-top: 10px">
                    <table class="table">
                        <thead>
                        <tr id="Department2">
                            <!--模态框内容-->
                        </tr>
                        </thead>
                    </table>
                </div>

                <div id="activity_addtable_employee" class="pull-right" style="display:none;width: 36%;overflow-y: scroll;height: 220px;margin-right: 10px;float: right;margin-top: 10px">
                    <table class="table">
                        <thead>
                        <tr id="Employee2">
                            <!--模态框内容-->
                        </tr>
                        </thead>
                    </table>
                </div>
                <!--选择类型-->
                <div style="width: 36%;margin-right: -5%;float: right;">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <input type="checkbox" checked  onclick="selectActivity()" id="Activity" />活动
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <input type="checkbox" onclick="selectMeeting()" id="Meeting" />会议
                </div>

            </div>
            <div class="modal-footer" style="margin-top: 300px">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消关闭</button>
                <button type="button" class="btn btn-primary" onclick="sendActivity()">确认新增</button>
            </div>
        </div>
    </div>
</div>

<!--------------------------------------新增活动/会议的模态框------------------------------------------------>




<div class="modal" id="themodal"  tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title modalTitle" id="title">模态弹出窗标题</h4>
            </div>
            <div class="modal-body">
                <p id="content" class="modalContent">内容</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<div class="modal" id="themodal2"  tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <form  method="post"  class="myform" action="DepartmentAdmin/uploadExcel"  enctype="multipart/form-data">
                    <p class="row">
                        <label for="excel">Excel:</label>
                        <input type="file" name="file" id="excel">
                    </p>
                    <input id="departmentid" name="departmentid"  value="1"type="text" hidden>
                    <input type="submit" class="submit" value="提交"/>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<div class="modal" id="themodal3"  tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <form  method="post" class="myform">
                    <p class="row row1">
                        <label for="name">姓名:</label>
                        <input type="text" name="file" id="name" required>
                    </p>
                    <p class="row row1">
                        <label for="account">用户名:</label>
                        <input type="text" name="file" id="account" required>
                    </p>
                    <p class="row row1">
                        <label for="duty">职位:</label>
                        <input type="text" name="sex" id="duty" required>
                    </p>
                    <p class="row row1">
                        <label for="sex">性别:</label>
                        <input type="text" name="sex" id="sex" required>
                    </p>
                    <p class="row row1">
                        <label for="telephone">联系电话:</label>
                        <input type="text" name="telephone" id="telephone" required>
                    </p>
                    <p class="row row1">
                        <label for="email">邮箱号码:</label>
                        <input type="text" name="email" id="email" required>
                    </p>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" onclick="addOneEmployee()">提交</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>

<div class="modal" id="themodal4"  tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="themodal4Label">添加班次——设置时间段</h4>
            </div>
            <div class="modal-body">
                <form  method="post" class="myform">
                    <p>
                        <label for="entertime">上班时间:</label>
                        <input type="time" class="form-control" name="entertime" id="entertime" required>
                    </p>
                    <p>
                        <label for="outtime">下班时间:</label>
                        <input type="time" class="form-control" name="outtime" id="outtime" required>
                    </p>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" onclick="addSchedule()">提交</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>

<div class="modal" id="themodal5"  tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <form  method="post" class="myform">
                    <p class="row row1">
                        <label for="duty1">职位:</label>
                        <input type="text" name="sex" id="duty1" required>
                    </p>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" onclick="changeEmployee()">提交</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<div class="modal" id="themodal6"  tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <form  method="post" class="myform">
                    <p>
                        <label for="entertime">上班时间:</label>
                        <input type="time" class="form-control" name="entertime" id="entertime1" required>
                    </p>
                    <p>
                        <label for="outtime">下班时间:</label>
                        <input type="time" class="form-control" name="outtime" id="outtime1" required>
                    </p>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" onclick="changeSchedule()">提交</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<div class="modal" id="themodal7"  tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title modalTitle" id="applicationTitle">模态弹出窗标题</h4>
            </div>
            <div class="modal-body">
                <p id="applicationContent" class="modalContent">内容</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" onclick="checkApplication()">通过</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<div class="modal" id="themodal8"  tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title modalTitle" id="scheduleEmployeeTitle">班次1</h4>
            </div>
            <div class="modal-body">
                <div  class="panel-body">
                    <table class="table table-striped table-hover table-bordered">
                        <thead>
                        <tr>
                            <!--调用全选js函数-->
                            <th>姓名</th>
                            <th>职位</th>
                            <th>性别</th>
                            <th>联系电话</th>
                            <th>邮箱号码</th>
                        </tr>
                        </thead>

                        <tbody id="scheduleEmployee">
                        <tr>
                            <td>1213123</td>
                            <td>张三</td>
                            <td>男</td>
                            <td>13428003404</td>
                            <td>13428003404@139.com</td>
                        </tr>
                        </tbody>
                    </table>
                    <!--分页-->

                    <div id="scheduleEmployeePagination" class="pagination">
                    </div>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>

</body>

<!----------------------------------- 动态加载发布通知新增活动以及导入Excel------------------------------------------>





<script>
    var selectStyle=0;//选择活动或会议 1-会议 0-活动
    function selectActivity(){
        var Activity = document.getElementById("Activity");
        var Meeting = document.getElementById("Meeting");
        if(Activity.checked){
            Meeting.checked=false;
            selectStyle=0;
        }
        else {
            Meeting.checked=true;
            selectStyle=1;
        }
    }
    function selectMeeting(){
        var Activity = document.getElementById("Activity");
        var Meeting = document.getElementById("Meeting");
        if(Meeting.checked){
            Activity.checked=false;
            selectStyle=1;
        }
        else {
            Activity.checked=true;
            selectStyle=0;
        }
    }

    //修改手机号码/邮箱
    function showChangeTelAndEmailHtml(){
        document.getElementById("changeTelAndEmailHtml").style.display="block";
        document.getElementById("employeeListTitle").style.display="none";
        document.getElementById("scheduleTitle").style.display="none";
        document.getElementById("notifyTitle").style.display="none";
        document.getElementById("activityTitle").style.display="none";
        document.getElementById("checkTitle").style.display="none";
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
        document.getElementById("attendanceInformationHtml").style.display="none";
        document.getElementById("activityInformationHtml").style.display="none";
        document.getElementById("allDateGraph").style.display="none";
        document.getElementById("activityAllDateGraph").style.display="none";
        getTelAndEmail();
//        document.getElementById("changeTelAndEmailHtml").style.display="block";
    }

    //    注销
    function outLogin(){
        var mymessage=confirm("是否确定退出？");
        if(mymessage==true)
        {	//传入的是cookie的名称不是cookie的值 应加引号“ ”
            delCookie("DepartmentAdminId");
            delCookie("EmployeeId");
            location.reload();
        }
        else{}

    }
    function delCookie(name){
        var exp = new Date();
        exp.setTime(exp.getTime() - 10000);
        document.cookie=name+"=v; expires="+exp.toGMTString();
    }


    function departmentlist_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_departmentlist_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_departmentlist_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

    function departmentAttendlist_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_departmentAttendlist_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_departmentAttendlist_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

    //			待通知信息界面
    function prepare_notify_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_prepare_notify_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_prepare_notify_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

    //			员工出勤情况记录表界面
    function attend_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_attend_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_attend_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

    function showContent(title,content)
    {
        $("#title").text(title);
        $("#content").text(content);
        $("#themodal6").modal();
    }




//    <!---------------------------------- 发布通知  ----------------------------->
//    function sendNotify() {
//        var notifyTip = document.getElementById("notifyTip").value;
//        var notifyContent = document.getElementById("notifyContent").value;
//        alert("test send Notify");
//        alert(companyRepresentativeId+" crid");
//        $.ajax({
//            type: 'post',
//            url: "AdminAccountManagement/addNotify",
//            data: 'content=' + notifyContent + '&title=' + notifyTip
//            + '&adscription=' + adscription + '&companyrepresentativeid=' + companyRepresentativeId,
//            //'&departmentids=' + departmentId +
//            success: function (data) {
//                alert(data["status"]);
//                getDepartmentEmployeeId();
//            },
//            error: function () {
//                alert("test  false");
//            }
//        })
//    }
//
//    function getDepartmentEmployeeId (){
////		alert("test getDEid");
//        $.ajax({
//            type: 'post',
//            url: "AdminAccountManagement/getDepartmentEmployeeId",
//            data: 'departmentids=' + departmentId,
//            success: function (data) {
//                var length = data.length;
//                for(var i=0;i<length;i++){
//                    employeeId[i]=data[i].employeeid
////					alert(employeeId[i]+" EID");
//                }
//                addEmployeeNotify();
//            },
//            error: function () {
//                alert("test  false");
//            }
//        })
//    }
//
//    function addEmployeeNotify(){
//        //如果部门是全选的
//        if(document.getElementById("addDepartment_checkbox_selectall1").checked){
//            $.ajax({
//                type: 'post',
//                url: "AdminAccountManagement/addEmployeeNotify",
//                data: 'employeeIds=' + departmentAdminEmployeeId,
//                //'&departmentids=' + departmentId +
//                success: function (data) {
//                    alert(data["status"]);
//                    window.location.reload();
//                },
//                error: function () {
//                    alert("test  false");
//                }
//            })
//        }
//        else{
//            var checkedList=new Array();
//            var j=0;
//            for(var i=0;i<DepartmentNum;i++){
//                if(departmentChecked[i])checkedList[j++]=employeeId[i];
//            }
//            $.ajax({
//                type: 'post',
//                url: "AdminAccountManagement/addEmployeeNotify",
//                data: 'employeeIds=' + checkedList,
//                success: function (data) {
//                    alert(data["status"]);
//                    window.location.reload();
//                },
//                error: function () {
//                    alert("test  false");
//                }
//            })
//        }
//    }
//    <!--------------------------------------- 发布通知 ----------------------------------------->
//
//
//    <!-------------------------------------- 新增活动/会议 -------------------------------------->
//    function sendActivity(){
//        var activityTip = document.getElementById("Activity_tip_input").value;
//        var activityContent = document.getElementById("reasonActivity_input").value;
//        var startTime = document.getElementById("ActivityStartTime").value;
//        var endTime = document.getElementById("ActivityEndTime").value;
//        var address = document.getElementById("Activity_address").value;
////		if(activityTip==null||activityContent==null||startTime==null||endTime==null||address==null) {
////				alert("不能为空");return;
////		}
////		else
////			{
//        alert("test sendActivity");
//
//        $.ajax({
//            type: 'post',
//            url: "AdminAccountManagement/addActivity",
//            data: 'activityname=' + activityTip + '&content=' + activityContent + '&address=' + address  + '&employeeid=' + '1',//暂时写静态
////				+ '&starttime=' + startTime + '&endtime=' + endTime ,
//            //'&departmentids=' + departmentId +
//            success: function (data) {
//                alert(data["status"]);
//                if(data["status"]==true)window.location.reload();
//            },
//            error: function () {
//                alert("test  false");
//            }
//        })
////		}
//    }
//
//    <!-------------------------------------- 新增活动/会议 -------------------------------------->



    //提示当前位置，改变标题颜色 目前有5个表格
    function pointTitle(i){

        document.getElementById("changeTelAndEmailHtml").style.display="none";
        document.getElementById("employeeListTitle").style.display="block";
        document.getElementById("scheduleTitle").style.display="block";
        document.getElementById("notifyTitle").style.display="block";
        document.getElementById("activityTitle").style.display="block";
        document.getElementById("checkTitle").style.display="block";
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
        document.getElementById("attendanceInformationHtml").style.display="none";
        document.getElementById("activityInformationHtml").style.display="none";
        document.getElementById("allDateGraph").style.display="none";
        for(var j=1;j<=5;j++){
            document.getElementById("navTitle"+j).style.color="";
        }
        document.getElementById("navTitle"+i).style.color="#E67E22";

    }

</script>

<script>
    function getEmployee() {
        $
                .ajax({
                    type : 'post',
                    url : "DepartmentAdmin/queryEmployee",
                    data: 'departmentid='+departmentId,
                    success : function(data) {
                        $(function() {

                            var length = data.length;
//                            $("#Pagination1").pagination(length, {
//                                items_per_page : 10,
//                                callback : pageselectCallback
//                            });
//
//                            function pageselectCallback(page_index, jq) {
//                                var items_per_page = 10;
//                                var max_elem = Math.min((page_index + 1)
//                                        * items_per_page, length);

                                $("#employee").html("");//html() 方法返回或设置被选元素的内容 (inner HTML)。
//                                for (var i = page_index * items_per_page; i < max_elem; i++) {
                                for (var i = 0; i < length; i++) {
                                    var s=i+1;
                                    var sex="";
                                    if(data[i].sex==true)
                                        sex='男';
                                    else
                                        sex="女";
                                    $("#employee")
                                            .append(
                                            '<tr><td><input type="checkbox" class="'+data[i].employeeid+'" id="my_departmentlist_checkbox_'+s+'"/></td><td>'
                                            + data[i].name
                                            + '</td><td>'
                                            + data[i].duties
                                            + '</td><td>'
                                            + sex
                                            + '</td><td>'
                                            + data[i].telephone
                                            + '</td><td>'
                                            + data[i].email
                                            + '</td></tr>');

                                }
                                return false;
//                            }
                        });
                    },
                    error : function() {
                        return;
                    }
                });
    }


    function getAndDeleteEmployeeids()
    {
        var employids=new Array();
        $("#employee input:checked").each(function(i,element)
        {
            employids[i]=$(element).attr("class");
        });
        deleteEmployeeids(employids);
    }
    function deleteEmployeeids(employeeids)
    {
        $
                .ajax({
                    type : 'post',
                    url : "DepartmentAdmin/deleteEmployeeids",
                    data: 'employeeids='+employeeids,
                    success : function(data) {
                        alert("删除成功");
                        getEmployee();
                    },
                    error : function() {
                        alert("删除失败");
                    }
                });
    }
    function getApplications() {
        $
                .ajax({
                    type : 'post',
                    url : "DepartmentAdmin/queryApplications",
                    data: 'departmentid='+departmentId,
                    success : function(data) {
                        $(function() {

                            var length = data.length;
//                            $("#Pagination2").pagination(length, {
//                                items_per_page : 10,
//                                callback : pageselectCallback
//                            });
//
//                            function pageselectCallback(page_index, jq) {
//                                var items_per_page = 10;
//                                var max_elem = Math.min((page_index + 1)
//                                        * items_per_page, length);

                                $("#applications").html("");//html() 方法返回或设置被选元素的内容 (inner HTML)。
//                                for (var i = page_index * items_per_page; i < max_elem; i++) {
                                for (var i = 0; i < length; i++) {
                                    var s=i+1;
                                    var num;
                                    if(data[i].status==true)
                                        num=3;
                                    else
                                        num=2;
                                    $("#applications")
                                            .append(
//                                            '<tr class="f'+num+'"><td><input type="checkbox" id="my_departmentAttendlist_checkbox_'+s+'"/></td><td>'
                                            '<tr class="f'+num+'"><td><span class="glyphicon glyphicon-info-sign"></span></td><td>'
                                            + data[i].applicationid
                                            + '</td><td onclick=showApplication("'+data[i].title+'","'+data[i].remark+'","'+data[i].dailyattendanceid+'","'+data[i].applicationid+'")><a>'
                                            + data[i].title
                                            + '</a></td><td>'
                                            + (new Date(data[i].applicationtime)).toLocaleString()
                                            + '</td></tr>');

                                }
                                return false;
//                            }
                        });
                    },
                    error : function() {
                        return;
                    }
                });
    }

    function checkApplication() {

        $
                .ajax({
                    type : 'post',
                    url : "DepartmentAdmin/checkApplication",
                    data: 'dailyattendanceid='+DailyAttendanceId+'&applicationid='+ApplicationId,
                    success : function(data) {
                        alert("修改成功");
                        getApplications();
                        DailyAttendanceId="";
                        ApplicationId="";
                    },
                    error : function() {
                        alert("修改失败");
                        return;
                    }
                });
    }

    function queryDepartmentSchedules() {
        $
                .ajax({
                    type : 'post',
                    url : "DepartmentAdmin/queryDepartmentSchedules",
                    data: 'departmentid='+departmentId,
                    success : function(data) {
                        $(function() {

                            var length = data.length;
//                            $("#Pagination4").pagination(length, {
//                                items_per_page : 10,
//                                callback : pageselectCallback
//                            });
//
//                            function pageselectCallback(page_index, jq) {
//                                var items_per_page = 10;
//                                var max_elem = Math.min((page_index + 1)
//                                        * items_per_page, length);

                                $("#departmentSchedules").html("");//html() 方法返回或设置被选元素的内容 (inner HTML)。
//                                for (var i = page_index * items_per_page; i < max_elem; i++) {
                                for (var i = 0; i < length; i++) {
                                    var s=i+1;
                                    $("#departmentSchedules")
                                            .append(
                                            '<tr><td><input type="checkbox" class="'+data[i].scheduleid+'" id="my_employeeslist_checkbox_'+s+'"/></td><td><a onclick=showScheduleEmployee("'+s+'","'+data[i].scheduleid+'")>'
                                            +s
                                            + '</a></td><td>'
                                            + data[i].entertime
                                            + '</td><td>'
                                            + data[i].outtime
                                            + '</td></tr>');

                                }
                                return false;
//                            }
                        });
                    },
                    error : function() {
                        return;
                    }
                });
    }
    function getAndDeleteDepartmentSchedules()
    {
        var scheduleids=new Array();
        $("#departmentSchedules input:checked").each(function(i,element)
        {
            scheduleids[i]=$(element).attr("class");
        });
        deleteDepartmentSchedules(scheduleids);
    }
    function deleteDepartmentSchedules(scheduleids)
    {
        $
                .ajax({
                    type : 'post',
                    url : "DepartmentAdmin/deleteDepartmentSchedules",
                    data: 'scheduleids='+scheduleids,
                    success : function(data) {
                        alert("删除成功");
                        queryDepartmentSchedules();
                    },
                    error : function() {
                        alert("删除失败");
                    }
                });
    }
    function queryNotifies() {
        $
                .ajax({
                    type : 'post',
                    url : "DepartmentAdmin/queryNotifies",
                    data: 'employeeid='+departmentAdminEmployeeId+'&status=false',
                    success : function(data) {
                        $(function() {

                            var length = data.length;
//                            $("#Pagination5").pagination(length, {
//                                items_per_page : 10,
//                                callback : pageselectCallback
//                            });
//
//                            function pageselectCallback(page_index, jq) {
//                                var items_per_page = 10;
//                                var max_elem = Math.min((page_index + 1)
//                                        * items_per_page, length);

                                $("#notifies").html("");//html() 方法返回或设置被选元素的内容 (inner HTML)。
//                                for (var i = page_index * items_per_page; i < max_elem; i++) {
                                for (var i = 0; i < length; i++) {
                                    var s=i+1;
                                    $("#notifies")
                                            .append(
//                                            '<tr class="f'+data[i].status+'"><td><input type="checkbox"  id="my_prepare_notify_checkbox_'+s+'"/></td><td>'
                                            '<tr class="f'+data[i].status+'"><td><span class="glyphicon glyphicon-info-sign"></span></td>'
                                            + '<td onclick=show("'+data[i].title+'","'+data[i].content+'","'+data[i].notifyid+'","'+data[i].employeeid+'")><a>'
                                            + data[i].title
                                            + '</a></td><td>'
                                            + data[i].adscription
                                            + '</td><td>'
                                            + (new Date(data[i].notifytime)).toLocaleString()
                                            + '</td></tr>');

                                }
                                return false;
//                            }
                        });
                    },
                    error : function() {
                        return;
                    }
                });
    }

    function queryActivites() {
        $
                .ajax({
                    type : 'post',
                    url : "DepartmentAdmin/queryActivites",
                    data: 'employeeid='+departmentAdminEmployeeId,
                    success : function(data) {
                        $(function() {

                            var length = data.length;
//                            $("#Pagination7").pagination(length, {
//                                items_per_page : 10,
//                                callback : pageselectCallback
//                            });
//
//                            function pageselectCallback(page_index, jq) {
//                                var items_per_page = 10;
//                                var max_elem = Math.min((page_index + 1)
//                                        * items_per_page, length);

                                $("#activities").html("");//html() 方法返回或设置被选元素的内容 (inner HTML)。
//                                for (var i = page_index * items_per_page; i < max_elem; i++) {
                                for (var i = 0; i < length; i++) {
                                    var s=i+1;
                                    var activityOrMeeting;
                                    if(data[i].style)activityOrMeeting="会议"
                                    else activityOrMeeting="活动";
                                    $("#activities")
                                            .append(
//                                            '<tr><td><input type="checkbox" id="my_business_trip_checkbox_'+s+'"/></td><td onclick=show("'+data[i].activityname+'","'+data[i].content+'","'+data[i].activityid+'",0)><a>'
                                            '<tr><td><span class="glyphicon glyphicon-info-sign"></span></td><td onclick=show("'+data[i].activityname+'","'+data[i].content+'","'+data[i].activityid+'",0)><a>'
                                            + data[i].activityname
                                            + '</a></td><td>'
                                            + (new Date(data[i].starttime)).toLocaleString()
                                            + '</td><td>'
                                            + (new Date(data[i].endtime)).toLocaleString()
                                            + '</td><td>'
                                            + data[i].address
                                            + '</td><td>'
                                            + activityOrMeeting
                                            + '</td></tr>');

                                }
                                return false;
//                            }
                        });
                    },
                    error : function() {
                        return;
                    }
                });
    }
    function updateNotifyStatus(employeeId,notifyId)
    {
        $.ajax({
            type : 'post',
            url : "DepartmentAdmin/updateNotifyStatus",
            data: 'employeeid='+employeeId+'&notifyid='+notifyId,
            success : function(data) {
                queryNotifies();
            },
            error : function() {
                queryNotifies();
            }

        });
    }

    function addOneEmployee()
    {
        var name=$("#name").val();
        var account=$("#account").val();
        var duty=$("#duty").val();
        var telephone=$("#telephone").val();
        var sex=$("#sex").val();
        if(sex=="男")
            sex=true;
        else
            sex=false;
        var telephone=$("#telephone").val();
        var email=$("#email").val();
        $.ajax({
            type : 'post',
            url : "DepartmentAdmin/addOneEmployee",
            data: 'name='+name+'&account='+account+'&duties='+duty+'&telephone='+telephone+'&sex='+sex+'&email='+email+'&departmentid='+departmentId,
            success : function(data) {
                getEmployee();
            },
            error : function() {
                alert("添加失败");
            }

        });
    }

    function changeEmployee()
    {
        var duty=$("#duty1").val();
        var employids=new Array();
        $("#employee input:checked").each(function(i,element)
        {
            employids[i]=$(element).attr("class");
        });
        $.ajax({
            type : 'post',
            url : "DepartmentAdmin/changeEmployee",
            data: 'employeeids='+employids+'&duties='+duty+'&departmentid='+departmentId,
            success : function(data) {
                getEmployee();
            },
            error : function() {
                alert("失败");
            }

        });
    }
    function addSchedule()
    {
        var entertime=$("#entertime").val();
        var outtime=$("#outtime").val();
        $.ajax({
            type : 'post',
            url : "DepartmentAdmin/addSchedule",
            data: 'entertime='+entertime+'&outtime='+outtime+'&departmentid='+departmentId,
            success : function(data) {
                queryDepartmentSchedules();
                $("#themodal4").modal('hide');
            },
            error : function() {
                queryDepartmentSchedules();
            }
        });
    }
    function changeSchedule()
    {
        var entertime=$("#entertime1").val();
        var outtime=$("#outtime1").val();
        var scheduleids=new Array();
        $("#departmentSchedules input:checked").each(function(i,element)
        {
            scheduleids[i]=$(element).attr("class");
        });
        $.ajax({
            type : 'post',
            url : "DepartmentAdmin/changeSchedule",
            data: 'entertime='+entertime+'&outtime='+outtime+'&departmentid='+departmentId+'&scheduleids='+scheduleids,
            success : function(data) {
                queryDepartmentSchedules();
            },
            error : function() {
                queryDepartmentSchedules();
            }

        });
    }
</script>

<!--自己定义的js-->
<script type="text/javascript">
    //			公司负责人才显示
    //			部门列表界面
    function departmentlist_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_departmentlist_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_departmentlist_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;
        }
    }

    //			公司负责人才显示
    //			部门总体出勤情况界面
    function departmentAttendlist_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_departmentAttendlist_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_departmentAttendlist_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

    //			员工列表界面
    function employeeslist_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_employeeslist_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_employeeslist_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

    //			出差登记/查询界面
    function business_trip_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_business_trip_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_business_trip_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

    //			待通知信息界面
    function prepare_notify_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_prepare_notify_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_prepare_notify_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

    //			历史通知信息界面
    function history_notify_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_history_notify_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_history_notify_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

    //			待审核信息界面
    function prepare_review_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_prepare_review_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_prepare_review_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

    //			历史审核信息界面
    function history_review_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_history_review_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_history_review_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

    //			员工出勤情况记录表界面
    function attend_select_all(){
        for(var i=1;i<=1000;i++)
        {
            var cbox_id="my_attend_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            //alert(cbox.value);
            if(document.getElementById("my_attend_checkbox_selectall").checked)
                cbox.checked=true;
            else
                cbox.checked=false;;
        }
    }

</script>
<!-- jQuery -->
<!--<script type="text/javascript" src="js/jquery.pagination.js"></script>-->
<!--<script src="js/jquery-3.1.1.min.js"></script>-->

<script src="admin/vendor/jquery/jquery.min.js"></script>
<script src="admin/vendor/jquery/bootstrap.js"></script>
<script type="text/javascript">
    +function ($) {
        $(function(){
            // class
            $(document).on('click', '[data-toggle^="class"]', function(e){
                e && e.preventDefault();
                console.log('abc');
                var $this = $(e.target), $class , $target, $tmp, $classes, $targets;
                !$this.data('toggle') && ($this = $this.closest('[data-toggle^="class"]'));
                $class = $this.data()['toggle'];
                $target = $this.data('target') || $this.attr('href');
                $class && ($tmp = $class.split(':')[1]) && ($classes = $tmp.split(','));
                $target && ($targets = $target.split(','));
                $classes && $classes.length && $.each($targets, function( index, value ) {
                    if ( $classes[index].indexOf( '*' ) !== -1 ) {
                        var patt = new RegExp( '\\s' +
                                $classes[index].
                                        replace( /\*/g, '[A-Za-z0-9-_]+' ).
                                        split( ' ' ).
                                        join( '\\s|\\s' ) +
                                '\\s', 'g' );
                        $($this).each( function ( i, it ) {
                            var cn = ' ' + it.className + ' ';
                            while ( patt.test( cn ) ) {
                                cn = cn.replace( patt, ' ' );
                            }
                            it.className = $.trim( cn );
                        });
                    }
                    ($targets[index] !='#') && $($targets[index]).toggleClass($classes[index]) || $this.toggleClass($classes[index]);
                });
                $this.toggleClass('active');
            });

            // collapse nav
            $(document).on('click', 'nav a', function (e) {
                var $this = $(e.target), $active;
                $this.is('a') || ($this = $this.closest('a'));

                $active = $this.parent().siblings( ".active" );
                $active && $active.toggleClass('active').find('> ul:visible').slideUp(200);

                ($this.parent().hasClass('active') && $this.next().slideUp(200)) || $this.next().slideDown(200);
                $this.parent().toggleClass('active');

                $this.next().is('ul') && e.preventDefault();

                setTimeout(function(){ $(document).trigger('updateNav'); }, 300);
            });
        });
    }(jQuery);
</script>


<!-------------------------------------------通知和活动会议的模态框的js--------------------------->

<script>
    //查到所属公司id
    var companyId=null;//获取的该部门管理员的公司id
    var companyName=null;//该部门管理员所在公司的名称
    var departmentNameList = new Array();//存放加载到的部门名称
    var employeeNameList = new Array();//存放加载到的员工名称
    var departmentIds = new Array();//存放各部门id
    var departmentChecked = new Array();
    var employeeChecked = new Array();
    var employeeIds = new Array();//存放该部门下所有员工的id
    var departmentEmployeeId = new Array();//存放各部门的管理员工id
    var adscription=null;//部门管理员所属的公司名称
    var thisDepartmentName=null;
    var departmentSelectall=false;//部门是否全选
    var employeeSelectall=false;//员工是否全选
    var sendNotifyGetEmployeeId = new Array();

    function getDepartmentAndEmployee(){
        $.ajax({
            type: 'post',
            url: "AdminAccountManagement/departmentGetCompanyId",
            data: 'departmentid=' + departmentId,
            success: function (data) {
                companyId=data[0].companyid;
//                alert(companyId+" companyId");

                <!-----------根据公司id查到其他部门----------->
                $.ajax({
                    type: 'post',
                    url: "AdminAccountManagement/selectDepartment",
                    data: 'companyid=' + companyId,
                    success: function (data) {
//                        alert("test getDepartmentList");
                        var length = data.length;
                        var flag = 0;//遍历到当前部门则置1,，当前部门不需要再部门列表显示
                        for (var i = 0; i < length; i++) {
                            if(data[i].departmentid==departmentId){
                                thisDepartmentName=data[i].name
                                adscription=thisDepartmentName;
                                flag=1;
                                i++;
                                document.getElementById("departmentName1").innerHTML=adscription;
                                document.getElementById("departmentName2").innerHTML=adscription;
                                document.getElementById("departmentName3").innerHTML=adscription;
                            }
                            departmentNameList[i-flag] = data[i].name;
                            departmentIds[i-flag] = data[i].departmentid;
                            departmentChecked[i-flag] = false;//默认为该部门未点击选中
                        }

                        <!-----------根据部门id查部门管理员的员工id----------->

                        $.ajax({
                            type: 'post',
                            url: "AdminAccountManagement/getDepartmentEmployeeId",
                            data: 'departmentids=' + departmentIds,
                            success: function (data) {
//                                alert("test getDepartmentEmployeeId");
                                var length = data.length;
//                                alert(length);
                                for(var i=0;i<length;i++) {
//                                    alert(data[i].employeeid);
                                    departmentEmployeeId[i] = data[i].employeeid;//部门负责人的员工id
//                                    alert(departmentEmployeeId[i]+"test departmentEmployeeId");
                                }

                                //都置为未选中
                                departmentSelectall=false;employeeSelectall=false;
//                                alert(departmentNameList.length+"test len1");
//                                alert(employeeNameList.length+"test len2");

                                for(var i=0;i<departmentNameList.length;i++)departmentChecked[i]=false;
                                for(var i=0;i<employeeNameList.length;i++)employeeChecked[i]=false;

                            },
                            error: function () {
                                alert("false getDepartmentEmployeeId");
                            }
                        });
                        <!-----------根据部门id查部门管理员的员工id----------->

                    },
                    error: function () {
                        alert("false  getDepartmentList");
                        return;
                    }
                });
                <!-----------根据公司id查到其他部门----------->

            },
            error: function () {
                alert("false   getCompanyId");
                return;
            }
        });

        <!-----------查询该部门的所有员工列表----------->
//        alert(departmentId);
        $.ajax({//根据该部门管理员的部门id查该部门下的员工列表
            type: 'post',
            url: "AdminAccountManagement/getEmployeeList",
            data: 'departmentid=' + departmentId,
            success: function (data) {
//                alert("test getEmployeeList");
                var length = data.length;
                document.getElementById("departmentEmployeeNum").innerHTML=length;
                for (var i = 0; i < length; i++) {
                    employeeNameList[i] = data[i].name;
                    employeeIds[i] = data[i].employeeid;
                    employeeChecked[i] = false;//默认为该员工未点击选中
                }
            },
            error: function () {
                alert("false  getEmployeeList");
                return;
            }
        });
        <!-----------查询该部门的所有员工列表----------->


        <!-----------查询该部门的管理员名称----------->

        $.ajax({
            type: 'post',
            url: "DepartmentAdmin/getDepartmentAdminEmployeeName",
            data: 'employeeid=' + departmentAdminEmployeeId,
            success: function (data) {
//             alert("test getDepartmentEmployeeName");
                document.getElementById("departmentAdminName1").innerHTML=data["DepartmentAdminName"];
                document.getElementById("departmentAdminName2").innerHTML=data["DepartmentAdminName"];
            },
            error: function () {
                alert("false getDepartmentEmployeeName");
            }
        });

        <!-----------查询该部门的管理员名称----------->

    }


    //第j个模态框
    function showDepartment_Notify(j){
        document.getElementById("NotifyDepartment").style.backgroundColor="#E67E22";
        document.getElementById("NotifyDepartment").style.color="#FFFFFF";
        document.getElementById("NotifyEmployees").removeAttribute("style");
        document.getElementById("my_addtable_employee").style.display="none";
        document.getElementById("my_addtable_department").style.display="block";

        $("#Department"+j).html("");
        $("#Department"+j)
                .append(
                '<li style="list-style-type: none;padding-left: 12%;">'
                +'<span style="color: #00a8f3 ;font-size: 120%" >部门</span>'
                +'<input  type="checkbox" id="addDepartment_checkbox_selectall1" style="float: right" onclick="addDepartment_checkbox_selectall('+j+')"/>'
                +'<p></p>'
                +'<div style="height:1px;border:none;border-top:1px solid #CFCFCF; border-radius:5px" ></div>'
                +'</li>'
        );
        if(departmentSelectall)document.getElementById("addDepartment_checkbox_selectall"+j).checked=true;
        var departmentListLength = departmentNameList.length;
        for(var i=0;i<departmentListLength;i++) {
//                    alert(departmentChecked[i]);
            if(departmentChecked[i])
                $("#Department"+j)
                        .append(
                        '<li style="list-style-type: none;padding-left: 12%;" >'
                        +'<a data-toggle="collapse"><span style="color: #00a8f3 ;">'+departmentNameList[i] +'</span></a><input checked style="float: right" type="checkbox" id="'+j+'addDepartment_checkbox_'+i+'" onclick="departmentsChecked('+i+','+j+')"/><p></p>'
                        +'</li>'
                );
            else
                $("#Department"+j)
                        .append(
                        '<li style="list-style-type: none;padding-left: 12%;" >'
                        +'<a data-toggle="collapse"><span style="color: #00a8f3 ;">'+departmentNameList[i] +'</span></a><input check style="float: right" type="checkbox" id="'+j+'addDepartment_checkbox_'+i+'" onclick="departmentsChecked('+i+','+j+')"/><p></p>'
                        +'</li>'
                );
        }
    }


    //对应第j个部门 第k个模态框
    function departmentsChecked(j,k){
        var cbox_id=k+"addDepartment_checkbox_"+j;
//        alert(cbox_id);
        if(document.getElementById(cbox_id).checked)departmentChecked[j]=true;
        else departmentChecked[j]=false;
//        alert(departmentChecked[j]+"  departmentChecked");
    }

    function employeesChecked(j,k){
        var cbox_id=k+"addEmployee_checkbox_"+j;
//        alert(cbox_id);
        if(document.getElementById(cbox_id).checked)employeeChecked[j]=true;
        else employeeChecked[j]=false;
//        alert(employeeChecked[j]+"  employeeChecked");
    }

    //部门全选
    function addDepartment_checkbox_selectall(j){
        var DepartmentNum=departmentNameList.length;
        for(var i=0;i<DepartmentNum;i++)
        {
            var cbox_id=j+"addDepartment_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
//                    alert(cbox.checked);
            if(document.getElementById("addDepartment_checkbox_selectall"+j).checked) {
                departmentSelectall=true;
                cbox.checked = true;
                departmentChecked[i]=true;
//                alert(departmentChecked[i]+"  departmentChecked "+i);
            }
            else {
                departmentSelectall=false;
                cbox.checked = false;
                departmentChecked[i]=false;
//                alert(departmentChecked[i]+"  departmentChecked "+i);
            }
        }
    }
    //员工全选
    function addEmployee_checkbox_selectall(j){
        var EmployeeNum=employeeNameList.length;
        for(var i=0;i<EmployeeNum;i++)
        {
            var cbox_id=j+"addEmployee_checkbox_"+i;
            var cbox=document.getElementById(cbox_id);
            if(document.getElementById("addEmployee_checkbox_selectall"+j).checked) {
                employeeSelectall=true;
                cbox.checked = true;
                employeeChecked[i]=true;
            }
            else {
                employeeSelectall=false;
                cbox.checked = false;
                employeeChecked[i]=false;
            }
        }
    }

    //发送通知时被选中的员工id或部门管理员的员工id
    function checkedEmployeeId(){
        var j=0;
        for(var i=0;i<departmentNameList.length;i++){
            if(departmentChecked[i])sendNotifyGetEmployeeId[j++]=departmentEmployeeId[i];
        }
        var k=sendNotifyGetEmployeeId.length;
        for(var i=0;i<employeeNameList.length;i++){
            if(employeeChecked[i])sendNotifyGetEmployeeId[k++]=employeeIds[i];
        }
        if(sendNotifyGetEmployeeId.length==0)alert("请选择通知的部门或员工");
    }

    //中间表
    function addEmployeeNotify(){
        for(var i=0;i<sendNotifyGetEmployeeId.length;i++)
//            alert(sendNotifyGetEmployeeId[i]+" test eid");
//        alert("test addEmployeeNotify");
        $.ajax({
            type: 'post',
            url: "AdminAccountManagement/addEmployeeNotify",
            data: 'employeeIds=' + sendNotifyGetEmployeeId,
            //'&departmentids=' + departmentId +
            success: function (data) {
//                alert(data["status"]);
                window.location.reload();
            },
            error: function () {
//                alert("test  false");
            }
        })
    }

    function sendNotify() {
        checkedEmployeeId();
        if(sendNotifyGetEmployeeId.length!=0) {//有选中发送的部门或员工才发送
//            alert("test sendNotify");
            var notifyTip = document.getElementById("tip_input").value;
            var notufyContent = document.getElementById("reason_input").value;
            $.ajax({
                type: 'post',
                url: "AdminAccountManagement/addNotify",
                data: 'content=' + notufyContent + '&title=' + notifyTip
                + '&adscription=' + adscription + '&employeeid=' + departmentAdminEmployeeId,
                //'&departmentids=' + departmentId +
                success: function (data) {
//                    alert(data["status"]);
                    addEmployeeNotify();
                },
                error: function () {
//                    alert("test  false");
                }
            })
        }
    }

    function showEmployees_Notify(j){
        document.getElementById("NotifyEmployees").style.backgroundColor="#E67E22";
        document.getElementById("NotifyEmployees").style.color="#FFFFFF";
        document.getElementById("NotifyDepartment").removeAttribute("style");
        document.getElementById("my_addtable_department").style.display="none";
        document.getElementById("my_addtable_employee").style.display="block";

        $("#Employee"+j).html("");
        $("#Employee"+j)
                .append(
                '<li style="list-style-type: none;padding-left: 12%;">'
                +'<span style="color: #00a8f3 ;font-size: 120%" >'+thisDepartmentName+'</span>'
                +'<input  type="checkbox" id="addEmployee_checkbox_selectall1" style="float: right" onclick="addEmployee_checkbox_selectall('+j+')"/>'
                +'<p></p>'
                +'<div style="height:1px;border:none;border-top:1px solid #CFCFCF; border-radius:5px" ></div>'
                +'</li>'
        );
        if(employeeSelectall)document.getElementById("addEmployee_checkbox_selectall"+j).checked=true;
        var employeeListLength = employeeNameList.length;
        for(var i=0;i<employeeListLength;i++) {
            if(employeeChecked[i])
                $("#Employee"+j)
                        .append(
                        '<li style="list-style-type: none;padding-left: 12%;" >'
                        +'<a data-toggle="collapse"><span style="color: #00a8f3 ;">'+employeeNameList[i] +'</span></a><input checked style="float: right" type="checkbox" id="'+j+'addEmployee_checkbox_'+i+'" onclick="employeesChecked('+i+','+j+')"/><p></p>'
                        +'</li>'
                );
            else
                $("#Employee"+j)
                        .append(
                        '<li style="list-style-type: none;padding-left: 12%;" >'
                        +'<a data-toggle="collapse"><span style="color: #00a8f3 ;">'+employeeNameList[i] +'</span></a><input check style="float: right" type="checkbox" id="'+j+'addEmployee_checkbox_'+i+'" onclick="employeesChecked('+i+','+j+')"/><p></p>'
                        +'</li>'
                );
        }
    }

    function showDepartment_Activity(j){
        document.getElementById("activityDepartment").style.backgroundColor="#E67E22";
        document.getElementById("activityDepartment").style.color="#FFFFFF";
        document.getElementById("activityEmployees").removeAttribute("style");
        document.getElementById("activity_addtable_employee").style.display="none";
        document.getElementById("activity_addtable_department").style.display="block";

        $("#Department"+j).html("");
        $("#Department"+j)
                .append(
                '<li style="list-style-type: none;padding-left: 12%;">'
                +'<span style="color: #00a8f3 ;font-size: 120%" >部门</span>'
                +'<input  type="checkbox" id="addDepartment_checkbox_selectall1" style="float: right" onclick="addDepartment_checkbox_selectall('+j+')"/>'
                +'<p></p>'
                +'<div style="height:1px;border:none;border-top:1px solid #CFCFCF; border-radius:5px" ></div>'
                +'</li>'
        );
        if(departmentSelectall)document.getElementById("addDepartment_checkbox_selectall"+j).checked=true;
        var departmentListLength = departmentNameList.length;
        for(var i=0;i<departmentListLength;i++) {
//                    alert(departmentChecked[i]);
            if(departmentChecked[i])
                $("#Department"+j)
                        .append(
                        '<li style="list-style-type: none;padding-left: 12%;" >'
                        +'<a data-toggle="collapse"><span style="color: #00a8f3 ;">'+departmentNameList[i] +'</span></a><input checked style="float: right" type="checkbox" id="'+j+'addDepartment_checkbox_'+i+'" onclick="departmentsChecked('+i+','+j+')"/><p></p>'
                        +'</li>'
                );
            else
                $("#Department"+j)
                        .append(
                        '<li style="list-style-type: none;padding-left: 12%;" >'
                        +'<a data-toggle="collapse"><span style="color: #00a8f3 ;">'+departmentNameList[i] +'</span></a><input check style="float: right" type="checkbox" id="'+j+'addDepartment_checkbox_'+i+'" onclick="departmentsChecked('+i+','+j+')"/><p></p>'
                        +'</li>'
                );
        }

    }
    function showEmployees_Activity(j){
        document.getElementById("activityEmployees").style.backgroundColor="#E67E22";
        document.getElementById("activityEmployees").style.color="#FFFFFF";
        document.getElementById("activityDepartment").removeAttribute("style");
        document.getElementById("activity_addtable_department").style.display="none";
        document.getElementById("activity_addtable_employee").style.display="block";

        $("#Employee"+j).html("");
        $("#Employee"+j)
                .append(
                '<li style="list-style-type: none;padding-left: 12%;">'
                +'<span style="color: #00a8f3 ;font-size: 120%" >'+thisDepartmentName+'</span>'
                +'<input  type="checkbox" id="addEmployee_checkbox_selectall1" style="float: right" onclick="addEmployee_checkbox_selectall('+j+')"/>'
                +'<p></p>'
                +'<div style="height:1px;border:none;border-top:1px solid #CFCFCF; border-radius:5px" ></div>'
                +'</li>'
        );
        if(employeeSelectall)document.getElementById("addEmployee_checkbox_selectall"+j).checked=true;
        var employeeListLength = employeeNameList.length;
        for(var i=0;i<employeeListLength;i++) {
            if(employeeChecked[i])
                $("#Employee"+j)
                        .append(
                        '<li style="list-style-type: none;padding-left: 12%;" >'
                        +'<a data-toggle="collapse"><span style="color: #00a8f3 ;">'+employeeNameList[i] +'</span></a><input checked style="float: right" type="checkbox" id="'+j+'addEmployee_checkbox_'+i+'" onclick="employeesChecked('+i+','+j+')"/><p></p>'
                        +'</li>'
                );
            else
                $("#Employee"+j)
                        .append(
                        '<li style="list-style-type: none;padding-left: 12%;" >'
                        +'<a data-toggle="collapse"><span style="color: #00a8f3 ;">'+employeeNameList[i] +'</span></a><input check style="float: right" type="checkbox" id="'+j+'addEmployee_checkbox_'+i+'" onclick="employeesChecked('+i+','+j+')"/><p></p>'
                        +'</li>'
                );
        }
    }

    //新增活动/会议
    function sendActivity(){
        var activityTip = document.getElementById("Activity_tip_input").value;
        var activityContent = document.getElementById("reasonActivity_input").value;
        var startTime = document.getElementById("ActivityStartTime").value;
        var endTime = document.getElementById("ActivityEndTime").value;
        var address = document.getElementById("Activity_address").value;
        alert(startTime+" , "+endTime);
        var date1 = new Date(startTime).getTime();
        startTime = new Date(date1).toLocaleString();
        var date2 = new Date(endTime).getTime();
        endTime = new Date(date2).toLocaleString();
//		if(activityTip==null||activityContent==null||startTime==null||endTime==null||address==null) {
//				alert("不能为空");return;
//		}
//		else
//			{
//        alert("test sendActivity");
        $.ajax({
            type: 'post',
            url: "AdminAccountManagement/addActivity",
            data: 'activityname=' + activityTip + '&content=' + activityContent + '&address=' + address
            + '&employeeid=' + departmentAdminEmployeeId + '&style=' + selectStyle,
//				+ '&starttime=' + startTime + '&endtime=' + endTime ,
            //'&departmentids=' + departmentId +
            success: function (data) {
                alert(data["status"]);
                if(data["status"]==true)window.location.reload();
            },
            error: function () {
                alert("test  false");
            }
        })
//		}
    }

</script>

<!------------------------------------------/通知和活动会议的模态框的js--------------------------->

<!----------------------------------- /动态加载发布通知新增活动以及导入Excel------------------------->
<script>
    function showScheduleEmployee(i,scheduleid)
    {
        $("#scheduleEmployeeTitle").text("班次"+i);
        getScheduleEmployee(scheduleid);
    }
    function showApplication(title,content,dailyAttendanceId,applicationId)
    {
        $("#applicationTitle").text(title);
        $("#applicationContent").text(content);
        DailyAttendanceId=dailyAttendanceId;
        ApplicationId=applicationId;
        $("#themodal7").modal();
    }
    function showContent(title,content)
    {
        $("#title").text(title);
        $("#content").text(content);
        $("#themodal").modal();
    }
    function showAddOneEmployee()
    {
        $("#themodal3").modal();
    }
    function showAddDepartmentSchedule()
    {
        $("#themodal4").modal();
    }
    function showChangeEmployee()
    {
        $("#themodal5").modal();
    }
    function showChangeDepartmentSchedule()
    {
        $("#themodal6").modal();
    }
    function uploadExcel()
    {
        $("#themodal2").modal();
    }
    function show(title,content,id,style)
    {
        showContent(title,content);
        if(style!=0)
        {
            employeeId=style;
            notifyId=id;
            Style=style;
            updateNotifyStatus(employeeId,notifyId);
            notifyId="";
        }
    }

</script>

<!--曲线图-->
<!--<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>-->
<script src="https://code.highcharts.com/highcharts.js"></script>

<script language="JavaScript">
//    $(document).ready(
            function Graph()  {
        var title = {
            text: '该月份出勤情况统计'
        };
        var subtitle = {
            text: 'Source: SignInSystem'
        };
        var xAxis = {
            categories: ['1', '2', '3', '4', '5', '6',
                '7', '8', '9', '10', '11', '12','13','14', '15', '16', '17', '18', '19',
                '20', '21', '22', '23', '24', '25','26', '27', '28', '29', '30', '31']
        };
        var yAxis = {
            title: {
                text: '数量'
            },
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        };

        var tooltip = {
            valueSuffix: '条记录'
        }

        var legend = {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'middle',
            borderWidth: 0
        };

        var series =  [
            {
                name: '出勤',
                data: [AttendanceNum[1], AttendanceNum[2],AttendanceNum[3],
                    AttendanceNum[4], AttendanceNum[5],AttendanceNum[6],
                    AttendanceNum[7],AttendanceNum[8], AttendanceNum[9],
                    AttendanceNum[10], AttendanceNum[11],AttendanceNum[12],
                    AttendanceNum[13],AttendanceNum[14], AttendanceNum[15],
                    AttendanceNum[16], AttendanceNum[17],AttendanceNum[18],
                    AttendanceNum[19], AttendanceNum[20],AttendanceNum[21],
                    AttendanceNum[22], AttendanceNum[23],AttendanceNum[24],
                    AttendanceNum[25],AttendanceNum[26], AttendanceNum[27],
                    AttendanceNum[28], AttendanceNum[29], AttendanceNum[30],
                    AttendanceNum[31]]
            },
            {
                name: '迟到',
                data: [LateNum[1], LateNum[2], LateNum[3],
                    LateNum[4],LateNum[5],LateNum[6],LateNum[7],
                    LateNum[8],LateNum[9],LateNum[10],LateNum[11],
                    LateNum[12],LateNum[13],LateNum[14],LateNum[15],
                    LateNum[16],LateNum[17],LateNum[18],LateNum[19],
                    LateNum[20],LateNum[21],LateNum[22],LateNum[23],
                    LateNum[24],LateNum[25],LateNum[26],LateNum[27],
                    LateNum[28],LateNum[29],LateNum[30],LateNum[31]]
            },
            {
                name: '早退',
                data: [BackEarlyNum[1],BackEarlyNum[2],BackEarlyNum[3],
                    BackEarlyNum[4],BackEarlyNum[5],BackEarlyNum[6],BackEarlyNum[7],
                    BackEarlyNum[8],BackEarlyNum[9],BackEarlyNum[10],BackEarlyNum[11],
                    BackEarlyNum[12],BackEarlyNum[13],BackEarlyNum[14],BackEarlyNum[15],
                    BackEarlyNum[16],BackEarlyNum[17],BackEarlyNum[18],BackEarlyNum[19],
                    BackEarlyNum[20],BackEarlyNum[21],BackEarlyNum[22],BackEarlyNum[23],
                    BackEarlyNum[24],BackEarlyNum[25],BackEarlyNum[26],BackEarlyNum[27],
                    BackEarlyNum[28],BackEarlyNum[29],BackEarlyNum[30],BackEarlyNum[31]]
            },
            {
                name: '迟到&早退',
                data: [LateAndBackEarlyNum[1],LateAndBackEarlyNum[2],LateAndBackEarlyNum[3],
                    LateAndBackEarlyNum[4],LateAndBackEarlyNum[5],LateAndBackEarlyNum[6],LateAndBackEarlyNum[7],
                    LateAndBackEarlyNum[8],LateAndBackEarlyNum[9],LateAndBackEarlyNum[10],LateAndBackEarlyNum[11],
                    LateAndBackEarlyNum[12],LateAndBackEarlyNum[13],LateAndBackEarlyNum[14],LateAndBackEarlyNum[15],
                    LateAndBackEarlyNum[16],LateAndBackEarlyNum[17],LateAndBackEarlyNum[18],LateAndBackEarlyNum[19],
                    LateAndBackEarlyNum[20],LateAndBackEarlyNum[21],LateAndBackEarlyNum[22],LateAndBackEarlyNum[23],
                    LateAndBackEarlyNum[24],LateAndBackEarlyNum[25],LateAndBackEarlyNum[26],LateAndBackEarlyNum[27],
                    LateAndBackEarlyNum[28],LateAndBackEarlyNum[29],LateAndBackEarlyNum[30],LateAndBackEarlyNum[31]]
            },
            {
                name: '缺勤',
                data: [AbsenteeismNum[1],AbsenteeismNum[2],AbsenteeismNum[3],
                    AbsenteeismNum[4],AbsenteeismNum[5],AbsenteeismNum[6],AbsenteeismNum[7],
                    AbsenteeismNum[8],AbsenteeismNum[9],AbsenteeismNum[10],AbsenteeismNum[11],
                    AbsenteeismNum[12],AbsenteeismNum[13],AbsenteeismNum[14],AbsenteeismNum[15],
                    AbsenteeismNum[16],AbsenteeismNum[17],AbsenteeismNum[18],AbsenteeismNum[19],
                    AbsenteeismNum[20],AbsenteeismNum[21],AbsenteeismNum[22],AbsenteeismNum[23],
                    AbsenteeismNum[24],AbsenteeismNum[25],AbsenteeismNum[26],AbsenteeismNum[27],
                    AbsenteeismNum[28],AbsenteeismNum[29],AbsenteeismNum[30],AbsenteeismNum[31]]
            }
        ];

        var json = {};

        json.title = title;
        json.subtitle = subtitle;
        json.xAxis = xAxis;
        json.yAxis = yAxis;
        json.tooltip = tooltip;
        json.legend = legend;
        json.series = series;

        $('#container').highcharts(json);
    }
//);
</script>




<!-------------------------------------------修改手机号码/邮箱的js-------------------------------->

<script>
//    已读 未读
    $(document).ready(function(){
        $("#f1").click(function(){
            $(".f0").hide();
            $(".f1").show();
        });
        $("#f0").click(function(){
            $(".f1").hide();
            $(".f0").show();
        });
        $("#f2").click(function(){
            $(".f3").hide();
            $(".f2").show();
        });
        $("#f3").click(function(){
            $(".f2").hide();
            $(".f3").show();
        });
    });

    var originalTel=null;
    var originalEmail=null;
    //加载手机号码和邮箱
    function getTelAndEmail(){
        var tel=document.getElementById("Tel");
        var email=document.getElementById("EmailAddress");
        $.ajax({type : 'post',
            url : "AdminAccountManagement/showTelephoneAndEmail",
            data: 'employeeid='+departmentAdminEmployeeId,
            success : function(data) {
                tel.value=data[0].telephone;
                email.value=data[0].email;
                originalTel=data[0].telephone;
                originalEmail=data[0].email;
            },
            error : function() {
                return;
            }
        });
    }

    //发送验证码
    //    function sendMessage () {
    //        var tel = document.getElementById("Tel");
    //        alert("test value:" + tel.value);
    //        alert("original tel:"+originalTel);
    //        if (originalTel != tel.value && tel.value != null && tel.value != " ") {
    //            alert("test running bindTel");
    //            $.ajax({
    //                type: 'post',
    //                url: "AdminAccountManagement/sendMessage",
    //                data: 'employeeid=' + cookie + '&telephone=' + tel.value,
    //                success: function (data) {
    //                    alert("test success" + data["status"]);
    //                    if(data["status"])$('#myModal').modal('show');
    //                },
    //                error: function () {
    //                    alert("test  false" + data["status"]);
    //                    return;
    //                }
    //            });
    //        }
    //        alert("手机号码不能为空或与原手机号码相同");
    //    }

    //绑定手机号码
    function bindTel(){
        //验证码
        var code = document.getElementById("code").value;
        var tel = document.getElementById("Tel");
//        alert("test code:"+code);
        $.ajax({
            type: 'post',
            url: "AdminAccountManagement/bindTelephone",
            data: 'employeeid=' + departmentAdminEmployeeId + '&code=' + code +'&telephone=' + tel.value,
            success: function (data) {
                alert("test status:" + data["status"]);
                if(data["status"]){
                    alert(01);
                    document.getElementById("changeTelAndEmailHtml").style.display="none";
                    document.getElementById("tip").style.display="block";
                }
                else alert("修改失败");
            },
            error: function () {
                alert("test  status:" + data["status"]);
                return;
            }
        });
    }
    //绑定邮箱
    function bindEmail(){
        var email=document.getElementById("EmailAddress");
//        alert("original email:"+originalEmail);
//        alert("test value:"+email.value);
        if(originalTel!=email.value && email.value!=null && email.value!=" ") {
            alert("test running bindEmail");
            $.ajax({
                type: 'post',
                url: "AdminAccountManagement/sendEmailCode",
                data: 'employeeid=' + departmentAdminEmployeeId + '&email=' + email.value,
                success: function (data) {
                    alert("test success：" + data["status"]);
                },
                error: function () {
                    alert("test  false：" + data["status"]);
                    return;
                }
            });
        }
    }
</script>

<!------------------------------------------/修改手机号码/邮箱的js--------------------------------->

<!--发送短信验证码以及重新发送验证码倒计时-->
<script type="text/javascript">
    var wait=60;
    function time(o) {
        if (wait == 0) {
            o.removeAttribute("disabled");
            o.value="免费获取验证码";
            wait = 60;
        } else {
            o.setAttribute("disabled", true);
            o.value=wait+"秒后可以重新发送";
            wait--;
            setTimeout(function() {
                        time(o)
                    },
                    1000)
        }

    }
    //获取验证码
    document.getElementById("sendMessageTime").onclick=function()
    {
        var tel = document.getElementById("Tel");
        if(originalTel == tel.value){alert("未修改");}
        else if(tel.value == null || tel.value == " "){alert("手机号码不能为空");}
        else {
            var tel = document.getElementById("Tel");
//            alert("test value:" + tel.value);
//            alert("original tel:"+originalTel);
            alert("test running bindTel");
            $.ajax({
                type: 'post',
                url: "AdminAccountManagement/sendMessage",
                data: 'employeeid=' + departmentAdminEmployeeId + '&telephone=' + tel.value,
                success: function (data) {
                    alert("test success：" + data["status"]);

                },
                error: function () {
                    alert("test  false：" + data["status"]);
                    return;
                }
            });
            time(this);
        }
    }
</script>
<!--/发送短信验证码以及重新发送验证码倒计时-->



<!--加载统计数据-->

<script>
    var LateDataPage=0;
    var BackEarlyDataPage=0;
    var LateAndBackEarlyDataPage=0;
    var AttendanceDataPage=0;
    var AbsenteeismDataPage=0;
    var seperator1 = "-";
    var seperator2 = ":";
    var month = new Date().getMonth() + 1;
    if (month >= 1 && month <= 9) {
        month = "0" + month;
    }
//    alert(month);

//    记录条数
    var LateNum = new Array();
    var BackEarlyNum = new Array();
    var LateAndBackEarlyNum = new Array();
    var AttendanceNum = new Array();
    var AbsenteeismNum = new Array();
    for(var i=1;i<=31;i++){
        LateNum[i]=0;
        BackEarlyNum[i]=0;
        LateAndBackEarlyNum[i]=0;
        AttendanceNum[i]=0;
        AbsenteeismNum[i]=0;
    }

//    迟到翻页
    function dayBeforeOfLate(){
        var date = new Date();
        var cutNum=30;//增加的天数
        LateDataPage=LateDataPage+1;
        if(month==1||month==3||month==5||month==7||month==8||month==10||month==12)
        {
            cutNum=31;
        }
        if((date.getDate() -LateDataPage)<1)LateDataPage=LateDataPage-cutNum;
        getLateInformation(LateDataPage);
    }
    function dayAfterOfLate(){
        var date = new Date();
        var addNum=30;//增加的天数
        var lastDay=30;//一个月最后一天的号数
        LateDataPage=LateDataPage-1;
        if(month==1||month==3||month==5||month==7||month==8||month==10||month==12)
        {
            addNum=31;lastDay=31;
        }
        if((date.getDate() -LateDataPage)>lastDay)LateDataPage=LateDataPage+addNum;
        getLateInformation(LateDataPage);
    }

//    出勤翻页
    function dayBeforeOfAttendance(){
        var date = new Date();
        var cutNum=30;//增加的天数
        AttendanceDataPage=AttendanceDataPage+1;
        if(month==1||month==3||month==5||month==7||month==8||month==10||month==12)
        {
            cutNum=31;
        }
        if((date.getDate() -AttendanceDataPage)<1)AttendanceDataPage=AttendanceDataPage-cutNum;
        getAttendanceInformation(AttendanceDataPage);
    }
    function dayAfterOfAttendance(){
        var date = new Date();
        var addNum=30;//增加的天数
        var lastDay=30;//一个月最后一天的号数
        AttendanceDataPage=AttendanceDataPage-1;
        if(month==1||month==3||month==5||month==7||month==8||month==10||month==12)
        {
            addNum=31;lastDay=31;
        }
        if((date.getDate() -AttendanceDataPage)>lastDay)AttendanceDataPage=AttendanceDataPage+addNum;
        getAttendanceInformation(AttendanceDataPage);
    }

//    缺勤翻页
    function dayBeforeOfAbsenteeism(){
        var date = new Date();
        var cutNum=30;//增加的天数
        AbsenteeismDataPage=AbsenteeismDataPage+1;
        if(month==1||month==3||month==5||month==7||month==8||month==10||month==12)
        {
            cutNum=31;
        }
        if((date.getDate() -AbsenteeismDataPage)<1)AbsenteeismDataPage=AbsenteeismDataPage-cutNum;
        getAbsenteeismInformation(AbsenteeismDataPage);
    }
    function dayAfterOfAbsenteeism(){
        var date = new Date();
        var addNum=30;//增加的天数
        var lastDay=30;//一个月最后一天的号数
        AbsenteeismDataPage=AbsenteeismDataPage-1;
        if(month==1||month==3||month==5||month==7||month==8||month==10||month==12)
        {
            addNum=31;lastDay=31;
        }
        if((date.getDate() -AbsenteeismDataPage)>lastDay)AbsenteeismDataPage=AbsenteeismDataPage+addNum;
        getAbsenteeismInformation(AbsenteeismDataPage);
    }

//    早退翻页
    function dayBeforeOfBackEarly(){
        var date = new Date();
        var cutNum=30;//增加的天数
        BackEarlyDataPage=BackEarlyDataPage+1;
        if(month==1||month==3||month==5||month==7||month==8||month==10||month==12)
        {
            cutNum=31;
        }
        if((date.getDate() -BackEarlyDataPage)<1)BackEarlyDataPage=BackEarlyDataPage-cutNum;
        getBackEarlyInformation(BackEarlyDataPage);
    }
    function dayAfterOfBackEarly(){
        var date = new Date();
        var addNum=30;//增加的天数
        var lastDay=30;//一个月最后一天的号数
        BackEarlyDataPage=BackEarlyDataPage-1;
        if(month==1||month==3||month==5||month==7||month==8||month==10||month==12)
        {
            addNum=31;lastDay=31;
        }
        if((date.getDate() -BackEarlyDataPage)>lastDay)BackEarlyDataPage=BackEarlyDataPage+addNum;
        getBackEarlyInformation(BackEarlyDataPage);
    }

//    迟到&早退翻页
    function dayBeforeOfLateAndBackEarly(){
        var date = new Date();
        var cutNum=30;//增加的天数
        LateAndBackEarlyDataPage=LateAndBackEarlyDataPage+1;
        if(month==1||month==3||month==5||month==7||month==8||month==10||month==12)
        {
            cutNum=31;
        }
        if((date.getDate() -LateAndBackEarlyDataPage)<1)LateAndBackEarlyDataPage=LateAndBackEarlyDataPage-cutNum;
        getLateAndBackEarlyInformation(LateAndBackEarlyDataPage);
    }
    function dayAfterOfLateAndBackEarly(){
        var date = new Date();
        var addNum=30;//增加的天数
        var lastDay=30;//一个月最后一天的号数
        LateAndBackEarlyDataPage=LateAndBackEarlyDataPage-1;
        if(month==1||month==3||month==5||month==7||month==8||month==10||month==12)
        {
            addNum=31;lastDay=31;
        }
        if((date.getDate() -LateAndBackEarlyDataPage)>lastDay)LateAndBackEarlyDataPage=LateAndBackEarlyDataPage+addNum;
        getLateAndBackEarlyInformation(LateAndBackEarlyDataPage);
    }


    function showDailyAttendance(){
        document.getElementById("changeTelAndEmailHtml").style.display="none";
        document.getElementById("employeeListTitle").style.display="none";
        document.getElementById("scheduleTitle").style.display="none";
        document.getElementById("notifyTitle").style.display="none";
        document.getElementById("activityTitle").style.display="none";
        document.getElementById("checkTitle").style.display="none";
        document.getElementById("allDateGraph").style.display="none";
        document.getElementById("activityInformationHtml").style.display="none";
        document.getElementById("attendanceInformationHtml").style.display="block";
    }

    function showActivityAttendanceInformation(){
        document.getElementById("changeTelAndEmailHtml").style.display="none";
        document.getElementById("employeeListTitle").style.display="none";
        document.getElementById("scheduleTitle").style.display="none";
        document.getElementById("notifyTitle").style.display="none";
        document.getElementById("activityTitle").style.display="none";
        document.getElementById("checkTitle").style.display="none";
        document.getElementById("allDateGraph").style.display="none";
        document.getElementById("activityInformationHtml").style.display="block";
        document.getElementById("attendanceInformationHtml").style.display="none";
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";

    }

    function showLateData(){
        document.getElementById("lateInformationTitle").style.display="block";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
        document.getElementById("allDateGraph").style.display="none";
        document.getElementById("activityLateInformationTitle").style.display="none";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityAttendanceInformationTitle").style.display="none";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="none";
    }
    function showBackEarlyData(){
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="block";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
        document.getElementById("allDateGraph").style.display="none";
        document.getElementById("activityLateInformationTitle").style.display="none";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityAttendanceInformationTitle").style.display="none";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="none";
    }
    function showLateAndBackEarly(){
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="block";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
        document.getElementById("allDateGraph").style.display="none";
        document.getElementById("activityLateInformationTitle").style.display="none";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityAttendanceInformationTitle").style.display="none";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="none";
    }
    function showAttendance(){
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="block";
        document.getElementById("absenteeismInformationTitle").style.display="none";
        document.getElementById("allDateGraph").style.display="none";
        document.getElementById("activityLateInformationTitle").style.display="none";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityAttendanceInformationTitle").style.display="none";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="none";
    }
    function showAbsenteeism(){
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("allDateGraph").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="block";
        document.getElementById("activityLateInformationTitle").style.display="none";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityAttendanceInformationTitle").style.display="none";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="none";
    }
    function showAllData(){
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
        document.getElementById("activityLateInformationTitle").style.display="none";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityAttendanceInformationTitle").style.display="none";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="none";
        document.getElementById("allDateGraph").style.display="block";

        Graph();
    }

    function showActivityLateData(){
        document.getElementById("activityLateInformationTitle").style.display="block";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityAttendanceInformationTitle").style.display="none";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="none";
        document.getElementById("allDateGraph").style.display="none";
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
    }
    function showActivityBackEarlyData(){
        document.getElementById("activityLateInformationTitle").style.display="none";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="block";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityAttendanceInformationTitle").style.display="none";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="none";
        document.getElementById("activityAllDateGraph").style.display="none";
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
    }
    function showActivityLateAndBackEarly(){
        document.getElementById("activityLateInformationTitle").style.display="none";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="block";
        document.getElementById("activityAttendanceInformationTitle").style.display="none";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="none";
        document.getElementById("activityAllDateGraph").style.display="none";
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
    }
    function showActivityAttendance(){
        document.getElementById("activityLateInformationTitle").style.display="none";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityAttendanceInformationTitle").style.display="block";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="none";
        document.getElementById("activityAllDateGraph").style.display="none";
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
    }
    function showActivityAbsenteeism(){
        document.getElementById("activityLateInformationTitle").style.display="none";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityAttendanceInformationTitle").style.display="none";
        document.getElementById("activityAllDateGraph").style.display="none";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="block";
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
    }
    function showActivityAllData(){
        document.getElementById("activityLateInformationTitle").style.display="none";
        document.getElementById("getActivityBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityLateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("activityAttendanceInformationTitle").style.display="none";
        document.getElementById("activityAbsenteeismInformationTitle").style.display="none";
        document.getElementById("lateInformationTitle").style.display="none";
        document.getElementById("getBackEarlyInformationTitle").style.display="none";
        document.getElementById("lateAndBackEarlyInformationTitle").style.display="none";
        document.getElementById("attendanceInformationTitle").style.display="none";
        document.getElementById("absenteeismInformationTitle").style.display="none";
        document.getElementById("activityAllDateGraph").style.display="block";
    }



    function getAttendanceInformation(N) {
        if(N==0)AttendanceDataPage=0;
        $.ajax({//根据该部门管理员的部门id查该部门下的员工列表
            type: 'post',
            url: "AttendanceInformation/getInformation",
            data: 'departmentid=' + departmentId + '&status=' + '1',
            success: function (data) {
                var date = new Date();
                var length = data.length;
                var dataNum = 0;//记录条数
                $("#attendanceInformation").html("");
                for (var i = 0; i < length; i++) {
                    document.getElementById("dayOfAttendance").innerHTML=(
                    date.getFullYear()+seperator1+month+seperator1+(date.getDate() - N));
                    if ((new Date(data[i].entertime)).getDate() == (date.getDate() - N)&&
                            ((new Date(data[i].entertime)).getMonth()+1)==month) {
                        dataNum++;
                        $("#attendanceInformation").append(
                                '<tr>><td>'
                                + data[i].name
                                + '</td><td>'
                                + (new Date(data[i].entertime)).toLocaleString()
                                + '</td><td>'
                                + (new Date(data[i].outtime)).toLocaleString()
                                + '</td><td>'
                                + data[i].accumulatedtime
                                + '</td></tr>'
                        );
                    }
                    if(N==0)
                    for(var j=1;j<=31;j++) {
//                        alert((new Date(data[i].entertime)).getDate()+"  "+j);
                        if ((new Date(data[i].entertime)).getDate()==j){
                            AttendanceNum[j]++;
//                            alert(AttendanceNum[j]);
                        }
                    }
                }
                if (dataNum == 0) {
                    $("#attendanceInformation").html("");
                    $("#attendanceInformation").append('<p style="margin-left: 30%">该日期没有数据</p>');
                }
            },
            error: function () {
                alert("false  getDataInforamtion");
                return;
            }
        });
    }

    function getLateInformation(N) {
        if(N==0)LateDataPage=0;
        $.ajax({//根据该部门管理员的部门id查该部门下的员工列表
            type: 'post',
            url: "AttendanceInformation/getInformation",
            data: 'departmentid=' + departmentId + '&status=' + '2',
            success: function (data) {
                var date = new Date();
                var length = data.length;
                var dataNum = 0;//记录条数
                $("#lateInformation").html("");
                for (var i = 0; i < length; i++) {
                    document.getElementById("dayOfLate").innerHTML=(
                            date.getFullYear()+seperator1+month+seperator1+(date.getDate() - N));
                    if ((new Date(data[i].entertime)).getDate() == (date.getDate() - N)&&
                            ((new Date(data[i].entertime)).getMonth()+1)==month) {
                        dataNum++;
                        $("#lateInformation").append(
                                '<tr><td>'
                                + data[i].name
                                + '</td><td>'
                                + (new Date(data[i].entertime)).toLocaleString()
                                + '</td><td>'
                                + (new Date(data[i].outtime)).toLocaleString()
                                + '</td><td>'
                                + data[i].accumulatedtime
                                + '</td></tr>'
                        );
                    }
                    if(N==0)
                        for(var j=1;j<=31;j++) {
//                        alert((new Date(data[i].entertime)).getDate()+"  "+j);
                            if ((new Date(data[i].entertime)).getDate()==j){
                                LateNum[j]++;
//                                alert(LateNum[j]);
                            }
                        }
                }
                if (dataNum == 0) {
                    $("#lateInformation").html("");
                    $("#lateInformation").append('<p style="margin-left: 30%">该日期没有数据</p>');
                }

            },
            error: function () {
                alert("false  getDataInforamtion");
                return;
            }
        });
    }

    function getBackEarlyInformation(N) {
        if(N==0)BackEarlyDataPage=0;
        $.ajax({//根据该部门管理员的部门id查该部门下的员工列表
            type: 'post',
            url: "AttendanceInformation/getInformation",
            data: 'departmentid=' + departmentId + '&status=' + '3',
            success: function (data) {
                var date = new Date();
                var length = data.length;
                var dataNum = 0;//记录条数
                $("#getBackEarlyInformation").html("");
                for (var i = 0; i < length; i++) {
                    document.getElementById("dayOfBackEarly").innerHTML=(
                    date.getFullYear()+seperator1+month+seperator1+(date.getDate() - N));
                    if ((new Date(data[i].entertime)).getDate() == (date.getDate() - N)&&
                            ((new Date(data[i].entertime)).getMonth()+1)==month) {
                        dataNum++;
                        $("#getBackEarlyInformation").append(
                                '<tr>><td>'
                                + data[i].name
                                + '</td><td>'
                                + (new Date(data[i].entertime)).toLocaleString()
                                + '</td><td>'
                                + (new Date(data[i].outtime)).toLocaleString()
                                + '</td><td>'
                                + data[i].accumulatedtime
                                + '</td></tr>'
                        );
                    }
                    if(N==0)
                        for(var j=1;j<=31;j++) {
//                        alert((new Date(data[i].entertime)).getDate()+"  "+j);
                            if ((new Date(data[i].entertime)).getDate()==j){
                                BackEarlyNum[j]++;
//                                alert(BackEarlyNum[j]);
                            }
                        }
                }
                if (dataNum == 0) {
                    $("#getBackEarlyInformation").html("");
                    $("#getBackEarlyInformation").append('<p style="margin-left: 30%">该日期没有数据</p>');
                }
            },
            error: function () {
                alert("false  getDataInforamtion");
                return;
            }
        });
    }

    function getLateAndBackEarlyInformation(N) {
        if(N==0)LateAndBackEarlyDataPage=0;
        $.ajax({//根据该部门管理员的部门id查该部门下的员工列表
            type: 'post',
            url: "AttendanceInformation/getInformation",
            data: 'departmentid=' + departmentId + '&status=' + '4',
            success: function (data) {
                var date = new Date();
                var length = data.length;
                var dataNum = 0;//记录条数
                $("#lateAndBackEarlyInformation").html("");
                for (var i = 0; i < length; i++) {
                    document.getElementById("dayOfLateAndBackEarly").innerHTML=(
                    date.getFullYear()+seperator1+month+seperator1+(date.getDate() - N));
                    if ((new Date(data[i].entertime)).getDate() == (date.getDate() - N)&&
                            ((new Date(data[i].entertime)).getMonth()+1)==month) {
                        dataNum++;
                        $("#lateAndBackEarlyInformation").append(
                                '<tr>><td>'
                                + data[i].name
                                + '</td><td>'
                                + (new Date(data[i].entertime)).toLocaleString()
                                + '</td><td>'
                                + (new Date(data[i].outtime)).toLocaleString()
                                + '</td><td>'
                                + data[i].accumulatedtime
                                + '</td></tr>'
                        );
                    }
                    if(N==0)
                        for(var j=1;j<=31;j++) {
//                        alert((new Date(data[i].entertime)).getDate()+"  "+j);
                            if ((new Date(data[i].entertime)).getDate()==j){
                                LateAndBackEarlyNum[j]++;
//                                alert(LateAndBackEarlyNum[j]);
                            }
                        }
                }
                if (dataNum == 0) {
                    $("#lateAndBackEarlyInformation").html("");
                    $("#lateAndBackEarlyInformation").append('<p style="margin-left: 30%">该日期没有数据</p>');
                }
            },
            error: function () {
                alert("false  getDataInforamtion");
                return;
            }
        });
    }

    function getAbsenteeismInformation(N){
        if(N==0)AbsenteeismDataPage=0;
        $.ajax({//根据该部门管理员的部门id查该部门下的员工列表
            type: 'post',
            url: "AttendanceInformation/getInformation",
            data: 'departmentid=' + departmentId + '&status=' + '5',
            success: function (data) {
                var date = new Date();
                var length = data.length;
                var dataNum = 0;//记录条数
                $("#absenteeismInformation").html("");
                for (var i = 0; i < length; i++) {
                    document.getElementById("dayOfAbsenteeism").innerHTML=(
                    date.getFullYear()+seperator1+month+seperator1+(date.getDate() - N));
                    if ((new Date(data[i].entertime)).getDate() == (date.getDate() - N)&&
                            ((new Date(data[i].entertime)).getMonth()+1)==month) {
                        dataNum++;
                        $("#absenteeismInformation").append(
                                '<tr>><td>'
                                + data[i].name
                                + '</td><td>'
                                + (new Date(data[i].entertime)).toLocaleString()
                                + '</td><td>'
                                + (new Date(data[i].outtime)).toLocaleString()
                                + '</td><td>'
                                + data[i].accumulatedtime
                                + '</td></tr>'
                        );
                    }
                    if(N==0)
                        for(var j=1;j<=31;j++) {
//                        alert((new Date(data[i].entertime)).getDate()+"  "+j);
                            if ((new Date(data[i].entertime)).getDate()==j){
                                AbsenteeismNum[j]++;
//                                alert(AbsenteeismNum[j]);
                            }
                        }
                }
                if (dataNum == 0) {
                    $("#absenteeismInformation").html("");
                    $("#absenteeismInformation").append('<p style="margin-left: 30%">该日期没有数据</p>');
                }
            },
            error: function () {
                alert("false  getDataInforamtion");
                return;
            }
        });
    }


    function getActivityAttendanceInformation() {
//        if(N==0)AttendanceDataPage=0;
        $.ajax({//根据该部门管理员的部门id查该部门下的员工列表
            type: 'post',
            url: "AttendanceInformation/getActivityAttendanceInformation",
            data: 'departmentid=' + departmentId + '&status=' + '1',
            success: function (data) {
//                var date = new Date();
                var length = data.length;
//                var dataNum = 0;//记录条数
                $("#activityAttendanceInformation").html("");
                if(length==0)$("#activityAttendanceInformation").append('<p style="margin-left: 30%">当前没有数据</p>');
                else
                for (var i = 0; i < length; i++) {
                        $("#activityAttendanceInformation").append(
                                '<tr>><td>'
                                + data[i].name
                                + '</td><td>'
                                + (new Date(data[i].entertime)).toLocaleString()
                                + '</td><td>'
                                + (new Date(data[i].outtime)).toLocaleString()
                                + '</td><td>'
                                + data[i].activityname
                                + '</td></tr>'
                        );
                    }
            },
            error: function () {
                alert("false  getDataInforamtion");
                return;
            }
        });
    }
    function getActivityLateInformation() {
//        if(N==0)AttendanceDataPage=0;
        $.ajax({//根据该部门管理员的部门id查该部门下的员工列表
            type: 'post',
            url: "AttendanceInformation/getActivityAttendanceInformation",
            data: 'departmentid=' + departmentId + '&status=' + '2',
            success: function (data) {
//                var date = new Date();
                var length = data.length;
//                var dataNum = 0;//记录条数
                $("#activityLateInformation").html("");
                if(length==0)$("#activityLateInformation").append('<p style="margin-left: 30%">当前没有数据</p>');
                else
                for (var i = 0; i < length; i++) {
                        $("#activityLateInformation").append(
                                '<tr>><td>'
                                + data[i].name
                                + '</td><td>'
                                + (new Date(data[i].entertime)).toLocaleString()
                                + '</td><td>'
                                + (new Date(data[i].outtime)).toLocaleString()
                                + '</td><td>'
                                + data[i].activityname
                                + '</td></tr>'
                        );
                    }
            },
            error: function () {
                alert("false  getDataInforamtion");
                return;
            }
        });
    }
    function getActivityBackEarlyInformation() {
//        if(N==0)AttendanceDataPage=0;
        $.ajax({//根据该部门管理员的部门id查该部门下的员工列表
            type: 'post',
            url: "AttendanceInformation/getActivityAttendanceInformation",
            data: 'departmentid=' + departmentId + '&status=' + '3',
            success: function (data) {
//                var date = new Date();
                var length = data.length;
//                var dataNum = 0;//记录条数
                $("#activityBackEarlyInformation").html("");
                if(length==0)$("#activityBackEarlyInformation").append('<p style="margin-left: 30%">当前没有数据</p>');
                else
                for (var i = 0; i < length; i++) {
                        $("#activityBackEarlyInformation").append(
                                '<tr>><td>'
                                + data[i].name
                                + '</td><td>'
                                + (new Date(data[i].entertime)).toLocaleString()
                                + '</td><td>'
                                + (new Date(data[i].outtime)).toLocaleString()
                                + '</td><td>'
                                + data[i].activityname
                                + '</td></tr>'
                        );
                    }
            },
            error: function () {
                alert("false  getDataInforamtion");
                return;
            }
        });
    }
    function getActivityLateAndBackEarlyInformation() {
//        if(N==0)AttendanceDataPage=0;
        $.ajax({//根据该部门管理员的部门id查该部门下的员工列表
            type: 'post',
            url: "AttendanceInformation/getActivityAttendanceInformation",
            data: 'departmentid=' + departmentId + '&status=' + '4',
            success: function (data) {
//                var date = new Date();
                var length = data.length;
//                var dataNum = 0;//记录条数
                $("#activityLateAndBackEarlyInformation").html("");
                if(length==0)$("#activityLateAndBackEarlyInformation").append('<p style="margin-left: 30%">当前没有数据</p>');
                else
                for (var i = 0; i < length; i++) {
                        $("#activityLateAndBackEarlyInformation").append(
                                '<tr>><td>'
                                + data[i].name
                                + '</td><td>'
                                + (new Date(data[i].entertime)).toLocaleString()
                                + '</td><td>'
                                + (new Date(data[i].outtime)).toLocaleString()
                                + '</td><td>'
                                + data[i].activityname
                                + '</td></tr>'
                        );
                    }
            },
            error: function () {
                alert("false  getDataInforamtion");
                return;
            }
        });
    }
    function getActivityAbsenteeismInformation() {
//        if(N==0)AttendanceDataPage=0;
        $.ajax({//根据该部门管理员的部门id查该部门下的员工列表
            type: 'post',
            url: "AttendanceInformation/getActivityAttendanceInformation",
            data: 'departmentid=' + departmentId + '&status=' + '5',
            success: function (data) {
//                var date = new Date();
                var length = data.length;
//                var dataNum = 0;//记录条数
                $("#activityAbsenteeismInformation").html("");
                if(length==0)$("#activityAbsenteeismInformation").append('<p style="margin-left: 30%">当前没有数据</p>');
                else
                for (var i = 0; i < length; i++) {
                        $("#activityAbsenteeismInformation").append(
                                '<tr>><td>'
                                + data[i].name
                                + '</td><td>'
                                + (new Date(data[i].entertime)).toLocaleString()
                                + '</td><td>'
                                + (new Date(data[i].outtime)).toLocaleString()
                                + '</td><td>'
                                + data[i].activityname
                                + '</td></tr>'
                        );
                    }
            },
            error: function () {
                alert("false  getDataInforamtion");
                return;
            }
        });
    }


//    function getNowFormatDate() {
//        var date = new Date();
//        var seperator1 = "-";
//        var seperator2 = ":";
//        var month = date.getMonth() + 1;
//        var strDate = date.getDate();
//        if (month >= 1 && month <= 9) {
//            month = "0" + month;
//        }
//        if (strDate >= 0 && strDate <= 9) {
//            strDate = "0" + strDate;
//        }
//        var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
//                + " " + date.getHours() + seperator2 + date.getMinutes()
//               + seperator2 + date.getSeconds();
//        alert(currentdate) ;
//    }

</script>

<!--/加载统计数据-->
</html>